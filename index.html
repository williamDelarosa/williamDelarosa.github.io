<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TAI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@24,400,0,0" />

  <!-- PWA & iOS support -->
  <meta name="theme-color" content="#111827"/>
  <link rel="manifest" href="data:application/manifest+json;base64,ewogICJuYW1lIjogIlRBSSIsCiAgInNob3J0X25hbWUiOiAiVEFJIiwKICAiZGVzY3JpcHRpb24iOiAiQXBwIGRpIFN0dWRpbyBwZXIgaWwgY29yc28gVEFJICcyNS8nMjYiLAogICJzdGFydF91cmwiOiAiLiIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzExMTgyNyIsCiAgInRoZW1lX2NvbG9yIjogIiMxMTE4MjciLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vd2lsbGlhbURlbGFyb3NhL3dpbGxpYW1EZWxhcm9zYS5naXRodWIuaW8vMmM2OGZiNWJlMzEzNmQzNDU4ZTA3M2VhOGM1MWRmYWY4Y2RmMzA0MS9yZWFkeS5wbmciLAogICAgICAic2l6ZXMiOiAiMTkyeDE5MiIsCiAgICAgICJ0eXBlIjogImltYWdlL3BuZyIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3dpbGxpYW1EZWxhcm9zYS93aWxsaWFtRGVsYXJvc2EuZ2l0aHViLmlvLzJjNjhmYjViZTMxMzZkMzQ1OGUwNzNlYThjNTFkZmFmOGNkZjMwNDEvcmVhZHkucG5nIiwKICAgICAgInNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9wbmciCiAgICB9CiAgXQp9">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="TAI">
  <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/williamDelarosa/williamDelarosa.github.io/2c68fb5be3136d3458e073ea8c51dfaf8cdf3041/ready.png">

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
    body {
      font-family: 'Inter', sans-serif;
    }

    /* Contenitore principale degli sfondi (Carosello e Sfondo Statico) */
    #background-container {
      background-color: #000; /* Sfondo di riserva */
    }

    /* SFONDO STATICO (USATO PER LE MATERIE) */
    #static-background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      transition: opacity 0.7s ease-in-out;
      opacity: 0;
    }

    /* CAROSELLO PER LA HOME: Contenitore delle slide */
    #image-carousel {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: none; /* Nascosto di default */
        overflow: hidden;
    }

    /* Immagine singola del carosello */
    .carousel-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        opacity: 0; /* Nascosta di default */
        /* Rimosse le animazioni di slide, solo fade (1.0s) */
        transition: opacity 1.0s ease-in-out;
        transform: translateX(0) !important; /* Assicura che non ci sia spostamento */
    }

    /* Classe per l'immagine attualmente visibile */
    .carousel-image.active {
        opacity: 1; /* Resa visibile */
        /* Rimosso transform: translateX(0); */
    }

    /* Overlay che gestisce la sfocatura e l'oscuramento */
    #background-overlay {
        transition: backdrop-filter 0.3s ease-in-out;
    }

    /* Stile base per la sfocatura (usato nelle pagine interne) */
    .blurred-overlay {
      backdrop-filter: blur(5px);
      -webkit-backdrop-filter: blur(5px);
    }

    #sidebar {
      transition: transform 0.3s ease-in-out;
      background: rgba(17, 24, 39, 0.75);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-right: 1px solid rgba(255, 255, 255, 0.1);
      /* Aggiunge la z-index più alta della sidebar per stare sopra l'overlay */
      z-index: 50;
    }
    /* Classe helper per mostrare la sidebar */
    .sidebar-open {
        transform: translateX(0) !important;
    }

    /* Regolazione del margine per desktop quando la sidebar è aperta */
    @media (min-width: 768px) {
        .main-content-shifted {
            margin-left: 18rem; /* w-72 è 18rem */
        }
        /* Aggiunta: Rende l'overlay trasparente su desktop quando la sidebar è aperta,
           ma NON deve reagire a click esterni (perché li abbiamo eliminati) */
        #overlay.desktop-transparent {
            background-color: transparent !important;
            backdrop-filter: none !important;
            -webkit-backdrop-filter: none !important;
        }
    }

    .content-panel {
      background: rgba(17, 24, 39, 0.7);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .flashcard-container {
      perspective: 1000px;
    }
    .flashcard {
      width: 100%;
      height: 300px;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.6s;
    }
    .flashcard.flipped {
      transform: rotateY(180deg);
    }
    .flashcard-face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 1.5rem;
      padding: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }
    .flashcard-front {
      background-color: #1f2937;
      border: 1px solid #374151;
    }
    .flashcard-back {
      background-color: #4b5563;
      transform: rotateY(180deg);
      border: 1px solid #6b7280;
    }
    .nav-button {
      background-color: #374151;
      color: #d1d5db;
      border-radius: 9999px;
      width: 4rem;
      height: 4rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .nav-button:hover {
      background-color: #4b5563;
      color: #fff;
      box-shadow: 0 10px 15px rgba(0,0,0,0.2);
      transform: scale(1.1);
    }
    .nav-button:disabled {
      opacity: 0.3;
      cursor: not-allowed;
      transform: scale(1);
      box-shadow: none;
    }

    /* Animazioni standard */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeOut {
      to { opacity: 0; transform: translateY(-10px); }
    }
    .fade-out { animation: fadeOut 0.3s ease-out forwards; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }

        @keyframes fadeInUp {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeInLeft {
          from { opacity: 0; transform: translateX(-20px); }
          to { opacity: 1; transform: translateX(0); }
        }
        @keyframes zoomIn {
          from { opacity: 0; transform: scale(0.8); }
          to { opacity: 1; transform: scale(1); }
        }

        @keyframes popIn {
      0% { opacity: 0; transform: scale(0.8); }
      100% { opacity: 1; transform: scale(1); }
    }
    .animated-button {
      opacity: 0;
      animation: popIn 0.4s ease-out forwards;
    }
    .sidebar-item {
      cursor: pointer;
      padding: 0.75rem;
      border-radius: 0.5rem;
      transition: background-color 0.2s;
    }
    .sidebar-item:hover {
      background-color: #2d3748;
    }
    .sidebar-item.active {
      background-color: #4b5563;
      color: #fff;
    }

    @keyframes red-blink {
      50% { color: #ef4444; } /* red-500 */
    }
    .blink-red-twice {
      animation: red-blink 0.5s ease-in-out 2;
    }




    @keyframes fadeInOpacity {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes fadeOutOpacity {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    .fade-in-5s {
        animation: fadeInOpacity 5s ease-in forwards;
    }
    .fade-out-1s {
        animation: fadeOutOpacity 1s ease-out forwards;
    }


    /* PRESENZE - CHART WITH NAMES */
    #presenze-chart-container {
      position: relative;
      height: 400px;
      width: 100%;
    }
  </style></style>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
<body class="bg-gray-900 text-gray-200 flex min-h-screen overflow-hidden">
  <!-- LOGIN OVERLAY -->
  <div id="firebase-login-overlay" class="fixed inset-0 z-[9999] bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 flex items-center justify-center p-4">
    <div class="bg-gray-800/50 backdrop-blur-lg rounded-2xl shadow-2xl p-8 w-full max-w-md border border-gray-700">
      <div class="text-center mb-8">
        <img src="https://raw.githubusercontent.com/williamDelarosa/williamDelarosa.github.io/2c68fb5be3136d3458e073ea8c51dfaf8cdf3041/ready.png" alt="Logo TAI" class="w-20 h-20 mx-auto mb-4 rounded-full">
        <h1 class="text-3xl font-bold text-white mb-2">TAI</h1>
        <p class="text-gray-400">Accedi per continuare</p>
      </div>
      <form id="firebase-login-form" class="space-y-4">
        <div>
          <label for="firebase-email" class="block text-sm font-medium text-gray-300 mb-2">Email</label>
          <input type="email" id="firebase-email" required class="w-full px-4 py-3 bg-gray-700/50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="tua@email.com">
        </div>
        <div>
          <label for="firebase-password" class="block text-sm font-medium text-gray-300 mb-2">Password</label>
          <input type="password" id="firebase-password" required class="w-full px-4 py-3 bg-gray-700/50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="••••••••">
        </div>
        <div id="firebase-error" class="hidden text-red-400 text-sm p-3 bg-red-900/20 rounded-lg border border-red-800"></div>
        <button type="submit" id="firebase-login-btn" class="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors">Accedi</button>
      </form>
    </div>
  </div>


  <div id="sidebar-hotzone" class="hidden md:block fixed top-0 left-0 h-full w-4 z-40"></div>

  <div id="background-container" class="fixed inset-0 z-0" data-current-key="">
    <!-- Immagine di sfondo statica per le pagine interne -->
    <div id="static-background"></div>

    <!-- CAROSELLO PER LA HOME -->
    <div id="image-carousel">
      <!-- Le immagini saranno iniettate qui dal JS -->
    </div>
    <!-- FINE CAROSELLO -->

    <!-- Overlay che può avere o non avere il blur -->
    <div id="background-overlay" class="absolute inset-0 bg-black/60"></div>
  </div>


  <div class="relative z-10 flex min-h-screen w-full">
    <!-- Sidebar -->
    <nav id="sidebar" class="w-72 min-h-screen p-4 fixed top-0 left-0 transform -translate-x-full">
      <div onclick="showHomeScreen()" class="cursor-pointer mb-8">
        <img src="https://raw.githubusercontent.com/williamDelarosa/williamDelarosa.github.io/2c68fb5be3136d3458e073ea8c51dfaf8cdf3041/ready.png"
             alt="Logo TAI" class="mx-auto w-32" />
      </div>
      <!-- Titolo sidebar MANTENUTO come da richiesta -->

      <div id="sidebar-list" class="space-y-2">
        <div>
          <button id="info-toggle" class="sidebar-item w-full flex justify-center items-center">
            <span class="material-symbols-sharp text-2xl" style="color: #81A1C1;">info</span>
          </button>
          <div id="info-dropdown" class="overflow-hidden transition-all duration-300 ease-in-out max-h-0">
            <div class="pt-2 pl-4 space-y-2">
              <a id="item-qualifica" href="https://www.calameo.com/read/008058670b6fc9cf3227f" target="_blank" class="block p-2 rounded-md hover:bg-gray-700">
                <h3 class="font-semibold text-sm">Qualifica</h3>
              </a>
            </div>
          </div>
        </div>

        <div>
          <button id="materie-toggle" class="sidebar-item w-full flex justify-center items-center">
            <span class="material-symbols-sharp text-2xl" style="color: #A3BE8C;">school</span>
          </button>
          <div id="materie-dropdown" class="overflow-hidden transition-all duration-300 ease-in-out max-h-0">
             <div class="pt-2 pl-4 space-y-1" id="materie-list-container">
                <!-- Subject dropdowns will be injected here by JS -->
             </div>
          </div>

        <div>
          <button id="strumenti-toggle" class="sidebar-item w-full flex justify-center items-center">
            <span class="material-symbols-sharp text-2xl" style="color: #D08770;">build</span>
          </button>
          <div id="strumenti-dropdown" class="overflow-hidden transition-all duration-300 ease-in-out max-h-0">
            <div class="pt-2 pl-4 space-y-2">
              <button id="presenze-btn" class="block w-full text-left p-2 rounded-md hover:bg-gray-700 transition-colors">
                <h3 class="font-semibold text-sm">Presenze</h3>
              </button>
            </div>
          </div>
        </div>
        </div>
    </nav>

    <!-- Main Content -->
    <!-- Rimosso md:ml-72 da qui e gestito dinamicamente in JS e CSS con main-content-shifted -->
    <main id="main-content" class="flex-1 transition-all duration-300 ease-in-out h-screen overflow-y-auto">
      <div class="p-4 md:p-8">
        <button id="menu-toggle"
                class="p-2 text-gray-400 hover:text-white fixed top-5 left-2 z-30 transform transition-all duration-300 ease-in-out focus:outline-none opacity-0 pointer-events-none">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        </button>

        <div id="app-container" class="w-full max-w-5xl mx-auto">
          <!-- Home Screen -->
          <div id="home-screen" class="hidden text-center h-screen flex flex-col justify-center items-center">
            <div id="home-animation-container" class="relative w-full h-full flex justify-center items-center">
                <p id="home-subtitle" class="text-xl font-semibold italic text-gray-300 absolute opacity-0">"fatti non foste a viver come bruti, ma per seguir virtute e canoscenza"</p>
                <div id="home-vertical-title" class="absolute inset-0 flex items-center justify-center opacity-0">
                    <div class="flex flex-col items-start justify-center text-red-600 font-black" style="line-height: 1.2;">
                        <div id="word-tecnico" class="flex items-baseline">
                            <span style="font-size: 20vh;">T</span>
                            <span class="text-white" style="font-size: 5vh; margin-left: -1.4ch;">ecnico</span>
                        </div>
                        <div id="word-automazione" class="flex items-baseline">
                            <span style="font-size: 20vh;">A</span>
                            <span class="text-white" style="font-size: 5vh; margin-left: -0.1ch;">utomazione</span>
                        </div>
                        <div id="word-industriale" class="flex items-baseline">
                            <span style="font-size: 20vh;">I</span>
                            <span class="text-white" style="font-size: 5vh; margin-left: -0.1ch;">ndustriale</span>
                        </div>
                    </div>
                </div>
            </div>
          </div>

          <!-- Subject Screen (content moved to sidebar) -->
          <div id="subject-screen" class="hidden">
             <div class="mb-12 pt-20 text-center">
              <h2 id="subject-title" class="text-4xl font-extrabold text-white uppercase mb-6"></h2>
            </div>
          </div>

          <!-- Real Quiz Screen -->
          <div id="real-quiz-screen" class="hidden">
            <div class="content-panel p-6 md:p-8 rounded-2xl mt-8">
              <div class="flex justify-between items-center mb-6">
                <h2 id="real-quiz-subject-title" class="text-2xl font-bold text-white">Quiz</h2>
                <p id="real-quiz-progress" class="text-sm font-medium text-gray-400"></p>
                <p id="real-quiz-score" class="text-sm font-medium text-gray-400">Punteggio: 0</p>
              </div>
              <div id="real-quiz-question" class="text-2xl font-semibold mb-8 text-center"></div>
              <div id="real-quiz-answers" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Answer buttons will be injected here -->
              </div>
            </div>
            <div class="flex justify-center mt-8">
                <button id="next-quiz-btn" onclick="nextQuizQuestion()" class="hidden bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg">
                    Prossima
                </button>
            </div>
          </div>

          <!-- Quiz Screen -->
          <div id="quiz-screen" class="hidden fade-in">
            <div class="content-panel p-6 md:p-8 rounded-2xl mt-8">
              <div id="progress-text" class="text-sm font-medium text-gray-400 mb-6 text-right"></div>
              <div class="flashcard-container">
                <div id="flashcard" class="flashcard cursor-pointer" onclick="flipCard()">
                  <div class="flashcard-face flashcard-front">
                    <p id="question-text" class="text-2xl font-semibold"></p>
                  </div>
                  <div class="flashcard-face flashcard-back">
                    <p id="answer-text" class="text-lg"></p>
                  </div>
                </div>
              </div>
            </div>
            <div class="flex justify-center gap-8 mt-8">
              <button id="prev-btn" onclick="previousQuestion()" class="nav-button">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8"
                     viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd"
                        d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"
                        clip-rule="evenodd" />
                </svg>
              </button>
              <button id="next-btn" onclick="nextQuestion()" class="nav-button">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8"
                     viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd"
                        d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                        clip-rule="evenodd" />
                </svg>
              </button>
            </div>
          </div>





          <!-- Real Quiz Results Screen -->
          <div id="real-quiz-results-screen" class="hidden text-center content-panel p-10 rounded-2xl fade-in">
            <p id="real-quiz-results-message" class="text-3xl font-bold text-white mb-8"></p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
              <button onclick="startRealQuiz(currentSubjectInfo.subjectId)"
                      class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg">
                Riprova Quiz
              </button>
              <button onclick="backToSubject()"
                      class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg">
                Torna alla materia
              </button>
            </div>
          </div>

          <!-- Results Screen -->
          <div id="results-screen" class="hidden text-center content-panel p-10 rounded-2xl fade-in">
            <p id="results-message" class="text-3xl font-bold text-white mb-8"></p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
              <button onclick="restartQuiz()"
                      class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg">
                Riprova Quiz
              </button>
            </div>
          </div>

          <!-- PRESENZE SCREEN - GRAFICO CON NOMI -->
          <div id="presenze-screen" class="hidden">
            <h1 class="text-4xl font-bold mb-2">Dashboard Presenze</h1>
            <p class="text-gray-400 mb-8">Riepilogo presenze al 04/11/2025</p>

            <!-- Pannello Riepilogo Generale -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
              <div class="content-panel p-6 rounded-lg flex flex-col items-center justify-center text-center">
                <h3 class="text-lg font-semibold text-gray-400 mb-2">Presenza Media</h3>
                <p id="avg-attendance-value" class="text-4xl font-bold text-white">--%</p>
              </div>
              <div class="content-panel p-6 rounded-lg flex flex-col items-center justify-center text-center">
                <h3 class="text-lg font-semibold text-gray-400 mb-2">Studenti Totali</h3>
                <p id="students-total" class="text-4xl font-bold text-white">--</p>
              </div>
              <div class="content-panel p-6 rounded-lg flex flex-col items-center justify-center text-center">
                <h3 class="text-lg font-semibold text-gray-400 mb-2">Studenti in Zona Sicura (>=90%)</h3>
                <p id="students-safe" class="text-4xl font-bold text-green-500">--</p>
              </div>
              <div class="content-panel p-6 rounded-lg flex flex-col items-center justify-center text-center">
                <h3 class="text-lg font-semibold text-gray-400 mb-2">Studenti a Rischio (<=70%)</h3>
                <p id="students-danger" class="text-4xl font-bold text-red-500">--</p>
              </div>
            </div>

            <!-- GRAFICO ANDAMENTO ORE -->
            <div class="content-panel p-6 rounded-lg">
              <h2 class="text-xl font-bold mb-4">Dettaglio Presenze Individuali</h2>
              <div id="presenze-chart-container">
                <canvas id="presenze-chart"></canvas>
              </div>
              <!-- LEGEND -->
              <div id="presenze-legend" class="flex justify-center gap-x-6 gap-y-2 flex-wrap mt-4 text-sm">
                <div class="flex items-center gap-2">
                  <span class="w-4 h-4 rounded-full" style="background-color: rgba(34, 197, 94, 1);"></span>
                  <span>>= 90%</span>
                </div>
                <div class="flex items-center gap-2">
                  <span class="w-4 h-4 rounded-full" style="background-color: rgba(234, 179, 8, 1);"></span>
                  <span>80-89%</span>
                </div>
                <div class="flex items-center gap-2">
                  <span class="w-4 h-4 rounded-full" style="background-color: rgba(249, 115, 22, 1);"></span>
                  <span>71-79%</span>
                </div>
                <div class="flex items-center gap-2">
                  <span class="w-4 h-4 rounded-full" style="background-color: rgba(239, 68, 68, 1);"></span>
                  <span><= 70%</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <!-- L'Overlay serve solo per oscurare su mobile quando la sidebar è aperta, NON gestisce i click. -->
    <div id="overlay"
         class="hidden fixed inset-0 bg-black/50 z-30"></div>
  </div>

  <script>
    // Aggiungi qui le tue citazioni
    const quotes = [
      {
        text: "Fatti non foste a viver come bruti, ma per seguir virtute e canoscenza.",
        author: "Dante Alighieri"
      },
      {
        text: "L'intelligenza non consiste soltanto nella conoscenza, ma anche nella capacità di applicare la conoscenza alla pratica.",
        author: "Aristotele"
      },
      {
        text: "Ci sono uomini che sanno tutto, peccato che questo è tutto quello che sanno.",
        author: "Niccolo' Macchiavelli"
      },
      {
        text: "L'immaginazione è più importante della conoscenza.",
        author: "Albert Einstein"
      },
      {
        text: "La saggezza è sapere di non sapere.",
        author: "Socrate"
      }
    ];

    const questions = {
      meccanica: [
        { question: "Cos'è la 'Deformazione Plastica'?", answer: "È la deformazione permanente di un materiale, che non recupera la sua forma originale dopo la rimozione del carico." },
        { question: "Qual è la funzione principale di un cuscinetto?", answer: "Ridurre l'attrito tra parti in movimento rotatorio o lineare e supportare i carichi." },
        { question: "Definisci il 'Modulo di Young'.", answer: "È una misura della rigidità di un materiale, ovvero il rapporto tra lo sforzo (stress) e la deformazione elastica (strain)." },
        { question: "Cosa rappresenta il 'carico di snervamento'?", answer: "Il punto oltre il quale un materiale inizia a deformarsi plasticamente." },
        { question: "Qual è la differenza tra 'durezza' e 'resilienza'?", answer: "La durezza è la resistenza alla penetrazione, la resilienza è la capacità di assorbire energia in campo elastico." },
        { question: "A cosa serve una 'chiavetta' in meccanica?", answer: "A trasmettere un momento torcente tra un albero e un mozzo." },
        { question: "Cos'è la 'fatica' di un materiale?", answer: "Il progressivo danneggiamento di un materiale sottoposto a carichi ciclici." },
        { question: "Qual è lo scopo di una 'saldatura'?", answer: "Unire permanentemente due o più pezzi metallici tramite fusione." },
        { question: "Cosa si intende per 'tolleranza dimensionale'?", answer: "L'intervallo di variazione ammesso per una quota dimensionale di un pezzo." },
        { question: "Qual è la funzione di una 'molla'?", answer: "Immagazzinare energia elastica e restituirla quando viene scaricata." },
        { question: "Cosa differenzia un 'moto alternativo' da un 'moto rotatorio'?", answer: "Il moto alternativo è un movimento periodico avanti e indietro, quello rotatorio è un movimento circolare continuo." },
        { question: "Cos'è un 'accoppiamento' in meccanica?", answer: "Un organo di collegamento tra due alberi per trasmettere il moto." },
        { question: "Qual è il principio di funzionamento di una 'vite'?", answer: "Trasformare un moto rotatorio in un moto lineare." },
        { question: "Cosa si intende per 'lubrificazione'?", answer: "L'interposizione di uno strato di lubrificante tra due superfici in moto relativo per ridurre l'attrito." },
        { question: "Qual è la differenza tra 'ghisa' e 'acciaio'?", answer: "L'acciaio ha un tenore di carbonio inferiore al 2%, la ghisa superiore." },
        { question: "Cos'è un 'disegno tecnico'?", answer: "Una rappresentazione grafica di un oggetto secondo norme e convenzioni standardizzate." },
        { question: "A cosa serve la 'quotatura' in un disegno tecnico?", answer: "A specificare le dimensioni e le tolleranze di un pezzo." },
        { question: "Cosa indica la 'rugosità superficiale'?", answer: "Il grado di finitura di una superficie lavorata." },
        { question: "Qual è la funzione di un 'ingranaggio'?", answer: "Trasmettere il moto rotatorio e la potenza tra due alberi." },
        { question: "Cosa si intende per 'rapporto di trasmissione'?", answer: "Il rapporto tra le velocità angolari di due ingranaggi accoppiati." },
        { question: "Qual è la differenza tra 'forza' e 'pressione'?", answer: "La forza è un'azione che tende a modificare lo stato di quiete o di moto di un corpo, la pressione è la forza per unità di superficie." },
        { question: "Cos'è l''attrito radente'?", answer: "La forza che si oppone al movimento tra due superfici a contatto." },
        { question: "Qual è lo scopo di un 'freno'?", answer: "Rallentare o arrestare il movimento di un corpo." },
        { question: "Cosa si intende per 'momento di una forza'?", answer: "La capacità di una forza di provocare la rotazione di un corpo attorno a un punto." },
        { question: "Qual è la differenza tra 'lavoro' ed 'energia'?", answer: "Il lavoro è il trasferimento di energia, l'energia è la capacità di compiere lavoro." },
        { question: "Cos'è la 'potenza' in meccanica?", answer: "Il lavoro compiuto nell'unità di tempo." },
        { question: "Qual è la funzione di un 'volano'?", answer: "Regolarizzare la velocità di rotazione di un albero motore." },
        { question: "Cosa si intende per 'centro di massa'?", answer: "Il punto geometrico in cui si può considerare concentrata tutta la massa di un corpo." },
        { question: "Qual è la differenza tra 'velocità' e 'accelerazione'?", answer: "La velocità è la rapidità con cui un corpo cambia posizione, l'accelerazione è la rapidità con cui cambia velocità." },
        { question: "Cos'è un 'sistema iperstatico'?", answer: "Un sistema con un numero di vincoli superiore a quello strettamente necessario per garantirne l'equilibrio." },
        { question: "A cosa serve un 'giunto cardanico'?", answer: "A trasmettere il moto tra due alberi i cui assi non sono allineati." },
        { question: "Cos'è la 'flessione' in una trave?", answer: "La deformazione di una trave soggetta a carichi trasversali." },
        { question: "Qual è la differenza tra 'trazione' e 'compressione'?", answer: "La trazione tende ad allungare un corpo, la compressione a schiacciarlo." },
        { question: "Cosa si intende per 'taglio' in meccanica?", answer: "L'azione di due forze parallele e discordi che tendono a far scorrere una parte di un corpo rispetto all'altra." },
        { question: "Qual è la funzione di un 'albero a camme'?", answer: "Trasformare il moto rotatorio in moto alternativo." },
        { question: "Cos'è un 'accoppiamento a frizione'?", answer: "Un accoppiamento che permette di collegare e scollegare gradualmente due alberi." },
        { question: "Qual è la differenza tra 'moto uniforme' e 'moto uniformemente accelerato'?", answer: "Nel moto uniforme la velocità è costante, in quello uniformemente accelerato l'accelerazione è costante." },
        { question: "Cosa si intende per 'inerzia'?", answer: "La tendenza di un corpo a mantenere il proprio stato di quiete o di moto." },
        { question: "Qual è la funzione di una 'biella'?", answer: "Collegare un pistone a un albero a gomiti." },
        { question: "Cos'è un 'manovellismo di spinta rotativa'?", answer: "Un meccanismo che trasforma il moto rotatorio in moto alternativo o viceversa." },
        { question: "A cosa serve un 'riduttore di velocità'?", answer: "A ridurre la velocità di rotazione di un albero aumentandone la coppia." },
        { question: "Cos'è la 'risonanza' in un sistema meccanico?", answer: "Il fenomeno per cui un sistema oscilla con ampiezza crescente se sottoposto a una forzante periodica con frequenza pari alla sua frequenza naturale." },
        { question: "Qual è la differenza tra 'statica' e 'dinamica'?", answer: "La statica studia l'equilibrio dei corpi, la dinamica il loro movimento." },
        { question: "Cosa si intende per 'vincolo' in meccanica?", answer: "Una limitazione alla libertà di movimento di un corpo." },
        { question: "Qual è la funzione di un 'perno'?", answer: "Realizzare un vincolo di cerniera tra due corpi." },
        { question: "Cos'è un 'diagramma di corpo libero'?", answer: "Una rappresentazione di un corpo isolato con tutte le forze esterne che agiscono su di esso." },
        { question: "A cosa serve un 'tensore degli sforzi'?", answer: "A descrivere lo stato di sforzo in un punto di un corpo." },
        { question: "Cos'è il 'criterio di resistenza di von Mises'?", answer: "Un criterio per prevedere la rottura di un materiale duttile." },
        { question: "Qual è la differenza tra 'progettazione' e 'verifica'?", answer: "La progettazione consiste nel dimensionare un componente, la verifica nel controllare che un componente esistente resista ai carichi." },
        { question: "Cosa si intende per 'coefficiente di sicurezza'?", answer: "Un fattore di maggiorazione dei carichi o di riduzione della resistenza per garantire la sicurezza di una struttura." }
      ],
      sicurezza: [
        { question: "Cosa si intende per 'sicurezza sul lavoro'?", answer: "L'insieme delle misure preventive da adottare per garantire la salute e la sicurezza dei lavoratori." },
        { question: "Chi è il 'datore di lavoro' ai fini della sicurezza?", answer: "Il soggetto titolare del rapporto di lavoro con il lavoratore." },
        { question: "Qual è il ruolo del 'Responsabile del Servizio di Prevenzione e Protezione' (RSPP)?", answer: "Coordina il servizio di prevenzione e protezione dai rischi." },
        { question: "Cosa si intende per 'valutazione dei rischi'?", answer: "L'analisi di tutti i rischi presenti in azienda per la salute e la sicurezza dei lavoratori." },
        { question: "Cos'è il 'Documento di Valutazione dei Rischi' (DVR)?", answer: "Il documento che raccoglie la valutazione di tutti i rischi e le misure di prevenzione." },
        { question: "Chi è il 'Rappresentante dei Lavoratori per la Sicurezza' (RLS)?", answer: "La persona eletta o designata per rappresentare i lavoratori per quanto concerne la sicurezza." },
        { question: "Cosa sono i 'Dispositivi di Protezione Individuale' (DPI)?", answer: "Attrezzature destinate ad essere indossate dal lavoratore per proteggerlo da uno o più rischi." },
        { question: "Qual è la differenza tra 'pericolo' e 'rischio'?", answer: "Il pericolo è una proprietà intrinseca di un fattore avente il potenziale di causare danni, il rischio è la probabilità che tale danno si verifichi." },
        { question: "Cosa si intende per 'formazione dei lavoratori' in materia di sicurezza?", answer: "Il processo educativo attraverso il quale i lavoratori apprendono le procedure di sicurezza." },
        { question: "Chi è il 'medico competente'?", answer: "Il medico che collabora con il datore di lavoro per la sorveglianza sanitaria dei lavoratori." },
        { question: "Cosa si intende per 'sorveglianza sanitaria'?", answer: "L'insieme degli atti medici finalizzati alla tutela dello stato di salute dei lavoratori." },
        { question: "Quali sono gli obblighi del 'lavoratore' in materia di sicurezza?", answer: "Prendersi cura della propria sicurezza e di quella delle altre persone presenti sul luogo di lavoro." },
        { question: "Cosa si intende per 'primo soccorso'?", answer: "L'insieme delle azioni che permettono di aiutare una o più persone in difficoltà." },
        { question: "Qual è lo scopo della 'prevenzione incendi'?", answer: "Ridurre la probabilità che si verifichi un incendio e limitarne le conseguenze." },
        { question: "Cosa si intende per 'rischio chimico'?", answer: "Il rischio associato all'esposizione ad agenti chimici pericolosi." },
        { question: "Cos'è il 'rischio biologico'?", answer: "Il rischio di esposizione ad agenti biologici che possono causare infezioni, allergie o intossicazioni." },
        { question: "Cosa si intende per 'rischio rumore'?", answer: "Il rischio di danni all'udito a causa dell'esposizione a livelli eccessivi di rumore." },
        { question: "Qual è il 'rischio vibrazioni'?", answer: "Il rischio associato all'esposizione a vibrazioni meccaniche trasmesse al corpo." },
        { question: "Cosa si intende per 'movimentazione manuale dei carichi'?", answer: "Le operazioni di trasporto o di sostegno di un carico ad opera di uno o più lavoratori." },
        { question: "Qual è il 'rischio elettrico'?", answer: "Il rischio di folgorazione, ustioni o incendi a causa del contatto con parti in tensione." },
        { question: "Cosa si intende per 'lavori in quota'?", answer: "L'attività lavorativa che espone il lavoratore al rischio di caduta da una quota posta ad altezza superiore a 2 m." },
        { question: "Quali sono le principali misure di 'protezione collettiva'?", answer: "Misure che proteggono più lavoratori contemporaneamente, come i parapetti o le reti di sicurezza." },
        { question: "Cosa si intende per 'ergonomia'?", answer: "La scienza che si occupa dell'interazione tra gli esseri umani e gli altri elementi di un sistema." },
        { question: "Qual è lo scopo della 'segnaletica di sicurezza'?", answer: "Fornire indicazioni o prescrizioni concernenti la sicurezza sul lavoro." },
        { question: "Cosa si intende per 'stress lavoro-correlato'?", answer: "La percezione di squilibrio avvertita dal lavoratore quando le richieste lavorative superano le sue capacità." },
        { question: "Chi è il 'preposto' alla sicurezza?", answer: "La persona che sovrintende all'attività lavorativa e garantisce l'attuazione delle direttive ricevute." },
        { question: "Cosa si intende per 'near miss' o 'quasi infortunio'?", answer: "Un qualsiasi evento che avrebbe potuto causare un infortunio ma non lo ha fatto." },
        { question: "Qual è la gerarchia delle 'misure di prevenzione'?", answer: "Eliminazione del rischio, sostituzione, misure di protezione collettiva, misure di protezione individuale." },
        { question: "Cosa si intende per 'piano di emergenza'?", answer: "Il documento che stabilisce le procedure da attuare in caso di emergenza." },
        { question: "Qual è il ruolo degli 'addetti all'emergenza'?", answer: "Intervenire in caso di emergenza per gestire la situazione e prestare soccorso." },
        { question: "Cosa si intende per 'rischio da atmosfere esplosive' (ATEX)?", answer: "Il rischio di esplosione dovuto alla presenza di miscele di aria e sostanze infiammabili." },
        { question: "Qual è la differenza tra 'informazione' e 'formazione'?", answer: "L'informazione fornisce notizie, la formazione mira a creare competenze." },
        { question: "Cosa si intende per 'rischio videoterminali' (VDT)?", answer: "I rischi per la vista e per l'apparato muscolo-scheletrico legati all'uso di videoterminali." },
        { question: "Quali sono i principali 'diritti dei lavoratori' in materia di sicurezza?", answer: "Diritto alla sicurezza, all'informazione, alla formazione e alla rappresentanza." },
        { question: "Cosa si intende per 'infortunio sul lavoro'?", answer: "Un evento traumatico avvenuto per causa violenta in occasione di lavoro, da cui sia derivata la morte o un'inabilità." },
        { question: "Qual è la differenza tra 'infortunio' e 'malattia professionale'?", answer: "L'infortunio ha una causa violenta ed immediata, la malattia professionale è contratta gradualmente a causa dell'esposizione a rischi." },
        { question: "Cosa si intende per 'agenti fisici' di rischio?", answer: "Rumore, vibrazioni, radiazioni, microclima, ecc." },
        { question: "Qual è lo scopo dell' 'addestramento'?", answer: "Far apprendere al lavoratore l'uso corretto di attrezzature, macchine o DPI." },
        { question: "Cosa si intende per 'rischio incendio'?", answer: "La probabilità che si verifichi un incendio e le sue possibili conseguenze." },
        { question: "Quali sono le 'classi di incendio'?", answer: "A (solidi), B (liquidi), C (gas), D (metalli), F (oli e grassi)." },
        { question: "Cosa si intende per 'lavori in ambienti confinati'?", answer: "Lavori in spazi con limitate aperture di accesso e ventilazione naturale sfavorevole." },
        { question: "Qual è il 'rischio stradale'?", answer: "Il rischio di incidenti durante gli spostamenti lavorativi." },
        { question: "Cosa si intende per 'manutenzione' ai fini della sicurezza?", answer: "L'insieme delle operazioni per mantenere in efficienza macchine e impianti." },
        { question: "Qual è il ruolo dell' 'Organismo Paritetico'?", answer: "Supportare le imprese nell'individuazione di soluzioni tecniche e organizzative per la sicurezza." },
        { question: "Cosa si intende per 'rischio biologico deliberato'?", answer: "L'uso intenzionale di agenti biologici per nuocere." },
        { question: "Quali sono le sanzioni per il mancato rispetto delle norme di sicurezza?", answer: "Sanzioni penali (arresto o ammenda) e amministrative." },
        { question: "Cosa si intende per 'buone prassi' in materia di sicurezza?", answer: "Soluzioni organizzative o procedurali coerenti con la normativa e le norme di buona tecnica." },
        { question: "Qual è il 'principio di precauzione'?", answer: "Adottare misure protettive anche in assenza di certezze scientifiche su un rischio." },
        { question: "Cosa si intende per 'salute' secondo l'OMS?", answer: "Uno stato di completo benessere fisico, mentale e sociale." },
        { question: "Qual è l'importanza della 'comunicazione' nella sicurezza sul lavoro?", answer: "È fondamentale per trasferire informazioni, procedure e promuovere una cultura della sicurezza." }
      ],
      elettrotecnica: [
        { question: "Cos'è la 'tensione elettrica'?", answer: "La differenza di potenziale elettrico tra due punti di un circuito." },
        { question: "Cosa si intende per 'corrente elettrica'?", answer: "Un flusso ordinato di cariche elettriche." },
        { question: "Qual è la 'legge di Ohm'?", answer: "V = I * R (Tensione = Corrente * Resistenza)." },
        { question: "Cos'è la 'resistenza elettrica'?", answer: "L'opposizione di un materiale al passaggio della corrente elettrica." },
        { question: "Qual è la differenza tra 'corrente continua' (CC) e 'corrente alternata' (CA)?", answer: "La corrente continua ha un flusso costante in una direzione, la corrente alternata inverte periodicamente la sua direzione." },
        { question: "Cosa si intende per 'potenza elettrica'?", answer: "Il lavoro elettrico compiuto nell'unità di tempo (P = V * I)." },
        { question: "Cos'è un 'circuito elettrico'?", answer: "Un percorso chiuso in cui può fluire la corrente elettrica." },
        { question: "Qual è la differenza tra un 'collegamento in serie' e un 'collegamento in parallelo'?", answer: "In serie i componenti sono uno dopo l'altro, in parallelo sono su rami diversi." },
        { question: "Cosa si intende per 'effetto Joule'?", answer: "La trasformazione di energia elettrica in calore per il passaggio di corrente in un resistore." },
        { question: "Cos'è un 'condensatore'?", answer: "Un componente che immagazzina energia in un campo elettrico." },
        { question: "Cos'è un 'induttore'?", answer: "Un componente che immagazzina energia in un campo magnetico." },
        { question: "Cosa si intende per 'frequenza' in un circuito in CA?", answer: "Il numero di cicli completi che l'onda compie in un secondo (misurata in Hertz)." },
        { question: "Cos'è un 'trasformatore'?", answer: "Una macchina elettrica che trasferisce energia elettrica da un circuito a un altro modificando i valori di tensione e corrente." },
        { question: "Qual è il principio di funzionamento di un 'motore elettrico'?", answer: "Converte l'energia elettrica in energia meccanica." },
        { question: "Cosa si intende per 'messa a terra'?", answer: "Il collegamento di una parte di un impianto elettrico a un dispersore nel terreno per motivi di sicurezza." },
        { question: "Qual è la funzione di un 'interruttore differenziale' (salvavita)?", answer: "Interrompere il flusso di corrente in caso di dispersione verso terra, proteggendo dalle folgorazioni." },
        { question: "Cosa si intende per 'cortocircuito'?", answer: "Un collegamento a bassissima resistenza tra due punti di un circuito a potenziale diverso." },
        { question: "Qual è la differenza tra 'materiali conduttori' e 'materiali isolanti'?", answer: "I conduttori lasciano passare facilmente la corrente, gli isolanti la bloccano." },
        { question: "Cos'è un 'diodo'?", answer: "Un componente a semiconduttore che permette il passaggio della corrente in una sola direzione." },
        { question: "Cos'è un 'transistor'?", answer: "Un dispositivo a semiconduttore usato per amplificare o commutare segnali elettrici." },
        { question: "Cosa si intende per 'campo elettrico'?", answer: "La regione dello spazio in cui una carica elettrica risente di una forza." },
        { question: "Cos'è il 'campo magnetico'?", answer: "La regione dello spazio in cui una calamita o una corrente elettrica risentono di una forza." },
        { question: "Cosa si intende per 'elettromagnetismo'?", answer: "La branca della fisica che studia i fenomeni elettrici e magnetici e le loro correlazioni." },
        { question: "Qual è la funzione di un 'fusibile'?", answer: "Interrompere un circuito fondendosi quando la corrente supera un valore di sicurezza." },
        { question: "Cosa si intende per 'impianto elettrico civile'?", answer: "L'insieme di componenti elettrici per la distribuzione di energia in un'abitazione." },
        { question: "Qual è la differenza tra 'tensione monofase' e 'tensione trifase'?", answer: "La monofase ha una sola fase, la trifase ha tre fasi sfasate tra loro di 120°." },
        { question: "Cosa si intende per 'cabina di trasformazione'?", answer: "L'impianto che riceve l'energia in alta o media tensione e la trasforma in bassa tensione per la distribuzione." },
        { question: "Qual è il ruolo delle 'centrali elettriche'?", answer: "Produrre energia elettrica su larga scala." },
        { question: "Cosa si intende per 'energie rinnovabili'?", answer: "Fonti di energia che si rigenerano naturalmente, come il sole, il vento, l'acqua." },
        { question: "Cos'è un 'inverter'?", answer: "Un dispositivo che converte la corrente continua in corrente alternata." },
        { question: "Qual è la funzione di un 'gruppo di continuità' (UPS)?", answer: "Fornire alimentazione elettrica in caso di blackout." },
        { question: "Cosa si intende per 'domotica'?", answer: "L'automazione delle funzioni di un'abitazione." },
        { question: "Qual è la differenza tra 'potenza attiva', 'potenza reattiva' e 'potenza apparente'?", answer: "La potenza attiva compie lavoro, la reattiva è scambiata con il campo elettromagnetico, l'apparente è la somma vettoriale delle due." },
        { question: "Cos'è il 'fattore di potenza' (cos φ)?", answer: "Il rapporto tra la potenza attiva e la potenza apparente." },
        { question: "A cosa serve il 'rifasamento'?", answer: "A ridurre l'assorbimento di potenza reattiva per migliorare l'efficienza di un impianto." },
        { question: "Cosa si intende per 'armonica' in un segnale elettrico?", answer: "Una componente sinusoidale con frequenza multipla della frequenza fondamentale." },
        { question: "Qual è il 'rischio elettrico'?", answer: "Il rischio di folgorazione, ustioni o incendi a causa dell'elettricità." },
        { question: "Cosa si intende per 'contatto diretto' e 'contatto indiretto'?", answer: "Contatto diretto con una parte attiva, contatto indiretto con una massa in tensione per un guasto." },
        { question: "Qual è la 'legge di Faraday' sull'induzione elettromagnetica?", answer: "Un campo magnetico variabile nel tempo genera una forza elettromotrice." },
        { question: "Cosa si intende per 'autoinduzione'?", answer: "La generazione di una forza elettromotrice in un circuito a causa della variazione della corrente che lo attraversa." },
        { question: "Cos'è un 'relè'?", answer: "Un interruttore azionato da un elettromagnete." },
        { question: "Qual è la funzione di un 'contattore'?", answer: "Un interruttore per il comando di carichi di potenza elevata." },
        { question: "Cosa si intende per 'quadro elettrico'?", answer: "Il centro di comando e protezione di un impianto elettrico." },
        { question: "Qual è la 'norma CEI 64-8'?", answer: "La principale norma tecnica per gli impianti elettrici in Italia." },
        { question: "Cosa si intende per 'grado di protezione IP'?", answer: "Indica il livello di protezione di un involucro contro la penetrazione di corpi solidi e liquidi." },
        { question: "Qual è la differenza tra 'motore sincrono' e 'motore asincrono'?", answer: "Nel motore sincrono il rotore gira alla stessa velocità del campo magnetico rotante, nell'asincrono gira a una velocità inferiore." },
        { question: "Cosa si intende per 'PLC' (Controllore a Logica Programmabile)?", answer: "Un computer industriale per l'automazione di processi." },
        { question: "Qual è la funzione di un 'sensore' in automazione?", answer: "Rilevare una grandezza fisica e trasformarla in un segnale elettrico." },
        { question: "Cosa si intende per 'attuatore'?", answer: "Un dispositivo che converte un segnale di comando in un'azione fisica." },
        { question: "Qual è il futuro della 'distribuzione elettrica'?", answer: "Le 'smart grid', reti intelligenti per una gestione efficiente dell'energia." }
      ],
      comunicazione: [
        { question: "Cos'è la 'comunicazione efficace'?", answer: "La capacità di trasmettere un messaggio in modo chiaro, conciso e comprensibile, ottenendo il risultato desiderato." },
        { question: "Quali sono i tre elementi principali della comunicazione?", answer: "Emittente, ricevente e messaggio." },
        { question: "Cosa si intende per 'comunicazione verbale'?", answer: "La comunicazione che avviene tramite l'uso delle parole, sia parlate che scritte." },
        { question: "Cos'è la 'comunicazione non verbale'?", answer: "La comunicazione che avviene attraverso il linguaggio del corpo, i gesti, le espressioni facciali." },
        { question: "Cosa si intende per 'comunicazione paraverbale'?", answer: "L'uso della voce per comunicare, includendo tono, volume, ritmo e pause." },
        { question: "Qual è l'importanza dell''ascolto attivo'?", answer: "Permette di comprendere appieno il messaggio dell'interlocutore, mostrando interesse e rispetto." },
        { question: "Cosa si intende per 'feedback' nella comunicazione?", answer: "La risposta che il ricevente dà all'emittente, indicando se il messaggio è stato ricevuto e compreso." },
        { question: "Qual è la differenza tra 'comunicazione assertiva', 'passiva' e 'aggressiva'?", answer: "L'assertività esprime le proprie idee rispettando gli altri, la passività le subisce, l'aggressività le impone." },
        { question: "Cosa si intende per 'empatia'?", answer: "La capacità di mettersi nei panni degli altri e comprendere i loro sentimenti." },
        { question: "Qual è il ruolo delle 'domande aperte' in una conversazione?", answer: "Incoraggiano l'interlocutore a fornire risposte dettagliate e articolate." },
        { question: "Cosa sono le 'barriere alla comunicazione'?", answer: "Fattori che ostacolano o distorcono la comunicazione, come pregiudizi, rumore o linguaggio tecnico." },
        { question: "Come si può superare il 'conflitto' in un team?", answer: "Attraverso la negoziazione, il compromesso e la ricerca di soluzioni vantaggiose per tutti." },
        { question: "Cos'è il 'team building'?", answer: "Un insieme di attività finalizzate a migliorare la coesione e la collaborazione all'interno di un gruppo di lavoro." },
        { question: "Qual è l'importanza della 'chiarezza' in un messaggio?", answer: "Evita fraintendimenti e assicura che il messaggio venga interpretato correttamente." },
        { question: "Cosa si intende per 'intelligenza emotiva'?", answer: "La capacità di riconoscere, comprendere e gestire le proprie emozioni e quelle degli altri." },
        { question: "Qual è la differenza tra 'fatto' e 'opinione'?", answer: "Un fatto è oggettivo e verificabile, un'opinione è una valutazione soggettiva." },
        { question: "Come si può dare un 'feedback costruttivo'?", answer: "Focalizzandosi sul comportamento e non sulla persona, essendo specifici e offrendo suggerimenti per migliorare." },
        { question: "Cos'è la 'persuasione'?", answer: "L'arte di convincere gli altri ad adottare un'idea o un comportamento." },
        { question: "Qual è il ruolo della 'fiducia' in un team?", answer: "È fondamentale per una comunicazione aperta, onesta e una collaborazione efficace." },
        { question: "Cosa si intende per 'public speaking'?", answer: "La capacità di parlare in pubblico in modo efficace e coinvolgente." },
        { question: "Come si può gestire l' 'ansia da prestazione' nel parlare in pubblico?", answer: "Con una buona preparazione, tecniche di respirazione e focalizzandosi sul messaggio." },
        { question: "Qual è l'importanza del 'contatto visivo'?", answer: "Crea connessione con l'interlocutore e dimostra sicurezza e onestà." },
        { question: "Cosa si intende per 'netiquette'?", answer: "L'insieme delle regole di buona educazione da seguire nella comunicazione online." },
        { question: "Qual è la differenza tra 'collaborazione' e 'cooperazione'?", answer: "La cooperazione è lavorare insieme per un obiettivo comune, la collaborazione implica anche la creazione di qualcosa di nuovo insieme." },
        { question: "Come si può migliorare la 'comunicazione interculturale'?", answer: "Essendo consapevoli delle differenze culturali, evitando stereotipi e mostrando rispetto." },
        { question: "Cos'è lo 'storytelling'?", answer: "L'arte di raccontare storie per comunicare un messaggio in modo memorabile ed emozionante." },
        { question: "Qual è il ruolo del 'leader' nella comunicazione di un team?", answer: "Facilitare la comunicazione, promuovere un ambiente aperto e dare l'esempio." },
        { question: "Cosa si intende per 'problem solving'?", answer: "Il processo di analisi di un problema per trovare la soluzione migliore." },
        { question: "Qual è la tecnica del 'brainstorming'?", answer: "Una tecnica di gruppo per generare un gran numero di idee in modo creativo e senza giudizio." },
        { question: "Cosa si intende per 'pensiero critico'?", answer: "La capacità di analizzare le informazioni in modo oggettivo e valutare gli argomenti." },
        { question: "Qual è l'importanza della 'gestione del tempo'?", answer: "Permette di organizzare le attività in modo efficiente, riducendo lo stress e aumentando la produttività." },
        { question: "Cosa si intende per 'delega'?", answer: "Affidare ad altri la responsabilità e l'autorità per svolgere un compito." },
        { question: "Qual è la differenza tra 'efficacia' ed 'efficienza'?", answer: "L'efficacia è fare le cose giuste, l'efficienza è fare le cose nel modo giusto." },
        { question: "Come si può costruire un 'rapport' con l'interlocutore?", answer: "Trovando punti in comune, usando un linguaggio simile e mostrando empatia." },
        { question: "Cos'è la 'Programmazione Neuro-Linguistica' (PNL)?", answer: "Un approccio alla comunicazione e allo sviluppo personale che si concentra sulla connessione tra processi neurologici, linguaggio e schemi comportamentali." },
        { question: "Qual è il 'modello di Shannon-Weaver' della comunicazione?", answer: "Un modello lineare che descrive la comunicazione come un processo di trasmissione di informazioni da una fonte a un destinatario." },
        { question: "Cosa si intende per 'comunicazione di massa'?", answer: "La comunicazione rivolta a un pubblico vasto ed eterogeneo attraverso i mass media." },
        { question: "Qual è il ruolo dei 'social media' nella comunicazione odierna?", answer: "Hanno rivoluzionato il modo in cui le persone e le aziende comunicano, creando nuove opportunità e sfide." },
        { question: "Cosa si intende per 'brand identity'?", answer: "L'insieme degli elementi visivi e verbali che definiscono e differenziano un marchio." },
        { question: "Qual è l'importanza della 'coerenza' nella comunicazione aziendale?", answer: "Garantisce che tutti i messaggi siano allineati con i valori e l'immagine del brand." },
        { question: "Cosa si intende per 'crisis communication'?", answer: "La gestione della comunicazione durante una crisi per proteggere la reputazione di un'organizzazione." },
        { question: "Qual è la differenza tra 'marketing' e 'pubblicità'?", answer: "Il marketing è il processo di creazione di valore per i clienti, la pubblicità è una forma di comunicazione a pagamento per promuovere un prodotto." },
        { question: "Cosa si intende per 'target audience'?", answer: "Il gruppo specifico di persone a cui si rivolge un messaggio o una campagna di comunicazione." },
        { question: "Qual è il ruolo della 'creatività' nella comunicazione?", answer: "Permette di creare messaggi originali e memorabili che catturano l'attenzione." },
        { question: "Cosa si intende per 'comunicazione interna'?", answer: "La comunicazione che avviene all'interno di un'organizzazione tra i suoi membri." },
        { question: "Qual è l'importanza di una 'cultura aziendale' forte?", answer: "Guida i comportamenti dei dipendenti e crea un senso di appartenenza." },
        { question: "Come si può promuovere l' 'innovazione' in un team?", answer: "Incoraggiando la sperimentazione, accettando il fallimento e premiando le nuove idee." },
        { question: "Cosa si intende per 'leadership situazionale'?", answer: "Adattare il proprio stile di leadership alla situazione e al livello di maturità dei collaboratori." },
        { question: "Qual è il ruolo del 'mentoring'?", answer: "Un professionista esperto (mentor) guida e supporta lo sviluppo di un'altra persona (mentee)." },
        { question: "Come si può costruire una 'rete di contatti' (networking) efficace?", answer: "Partecipando a eventi, coltivando relazioni autentiche e offrendo valore agli altri." }
      ],
      matematica: [
        { question: "Cos'è un 'numero primo'?", answer: "Un numero naturale maggiore di 1 che ha solo due divisori: 1 e se stesso." },
        { question: "Qual è il 'teorema di Pitagora'?", answer: "In un triangolo rettangolo, il quadrato costruito sull'ipotenusa è uguale alla somma dei quadrati costruiti sui cateti (a² + b² = c²)." },
        { question: "Cosa si intende per 'derivata' di una funzione?", answer: "Il tasso di variazione istantanea di una funzione, o la pendenza della retta tangente al grafico della funzione in un punto." },
        { question: "Cos'è un 'integrale'?", answer: "L'operazione inversa della derivata, che permette di calcolare l'area sottesa al grafico di una funzione." },
        { question: "Qual è la differenza tra 'equazione' e 'disequazione'?", answer: "Un'equazione stabilisce un'uguaglianza, una disequazione stabilisce una disuguaglianza (maggiore, minore, ecc.)." },
        { question: "Cosa si intende per 'funzione' in matematica?", answer: "Una relazione tra due insiemi che associa a ogni elemento del primo insieme uno e un solo elemento del secondo." },
        { question: "Cos'è il 'pi greco' (π)?", answer: "Una costante matematica che rappresenta il rapporto tra la circonferenza di un cerchio e il suo diametro (circa 3.14159)." },
        { question: "Qual è la formula per l'area di un 'cerchio'?", answer: "A = π * r², dove r è il raggio." },
        { question: "Cosa si intende per 'matrice'?", answer: "Una tabella rettangolare di numeri, simboli o espressioni, disposti per righe e colonne." },
        { question: "Cos'è un 'vettore'?", answer: "Un ente matematico caratterizzato da modulo (o intensità), direzione e verso." },
        { question: "Qual è la differenza tra 'scalare' e 'vettore'?", answer: "Uno scalare è definito da un solo numero (es. temperatura), un vettore da modulo, direzione e verso (es. forza)." },
        { question: "Cosa si intende per 'limite' di una funzione?", answer: "Il valore a cui la funzione si avvicina quando la sua variabile indipendente si avvicina a un certo valore." },
        { question: "Cos'è un 'logaritmo'?", answer: "L'esponente da dare a un numero (la base) per ottenere un altro numero (l'argomento)." },
        { question: "Qual è la differenza tra 'probabilità' e 'statistica'?", answer: "La probabilità si occupa di prevedere la verosimiglianza di eventi futuri, la statistica di analizzare dati passati." },
        { question: "Cosa si intende per 'media', 'mediana' e 'moda'?", answer: "Sono indici di posizione in statistica: la media è la somma dei valori divisa per il loro numero, la mediana è il valore centrale, la moda è il valore più frequente." },
        { question: "Cos'è un 'numero complesso'?", answer: "Un numero che può essere espresso nella forma a + bi, dove a e b sono numeri reali e i è l'unità immaginaria (√-1)." },
        { question: "Qual è il 'principio di induzione'?", answer: "Un metodo di dimostrazione matematica usato per provare che una certa proprietà vale per tutti i numeri naturali." },
        { question: "Cosa si intende per 'serie numerica'?", answer: "La somma degli infiniti termini di una successione." },
        { question: "Qual è la differenza tra 'geometria euclidea' e 'geometrie non euclidee'?", answer: "La geometria euclidea si basa sui postulati di Euclide, le geometrie non euclidee ne negano almeno uno (tipicamente il quinto, quello delle rette parallele)." },
        { question: "Cosa si intende per 'trigonometria'?", answer: "La branca della matematica che studia le relazioni tra i lati e gli angoli dei triangoli." },
        { question: "Quali sono le principali 'funzioni trigonometriche'?", answer: "Seno (sin), coseno (cos) e tangente (tan)." },
        { question: "Cos'è un 'polinomio'?", answer: "Un'espressione algebrica composta dalla somma di più monomi." },
        { question: "Cosa si intende per 'fattorizzazione' di un polinomio?", answer: "Scomporre un polinomio nel prodotto di polinomi di grado inferiore." },
        { question: "Qual è il 'teorema fondamentale dell'algebra'?", answer: "Ogni polinomio a coefficienti complessi di grado n ≥ 1 ha esattamente n radici complesse (contate con la loro molteplicità)." },
        { question: "Cosa si intende per 'spazio vettoriale'?", answer: "Un insieme di vettori in cui sono definite le operazioni di somma tra vettori e di prodotto di un vettore per uno scalare." },
        { question: "Cos'è un 'autovalore' di una matrice?", answer: "Uno scalare λ tale che, per un dato vettore non nullo v, Av = λv." },
        { question: "Cosa si intende per 'equazione differenziale'?", answer: "Un'equazione che lega una funzione incognita alle sue derivate." },
        { question: "Qual è la differenza tra 'algebra' e 'analisi'?", answer: "L'algebra si occupa di strutture algebriche e manipolazione di simboli, l'analisi si occupa di limiti, continuità, derivate e integrali." },
        { question: "Cosa si intende per 'topologia'?", answer: "La branca della matematica che studia le proprietà delle figure che non cambiano per deformazioni continue." },
        { question: "Cos'è un 'frattale'?", answer: "Un oggetto geometrico che si ripete nella sua forma allo stesso modo su scale diverse." },
        { question: "Qual è la 'sezione aurea' (φ)?", answer: "Un rapporto numerico (circa 1.618) che si ritrova in natura e nell'arte, definito dalla proporzione (a+b)/a = a/b." },
        { question: "Cosa si intende per 'calcolo combinatorio'?", answer: "Il calcolo del numero di modi in cui si possono raggruppare o ordinare gli elementi di un insieme." },
        { question: "Qual è la differenza tra 'permutazioni' e 'combinazioni'?", answer: "Nelle permutazioni conta l'ordine degli elementi, nelle combinazioni no." },
        { question: "Cosa si intende per 'teoria dei grafi'?", answer: "Lo studio dei grafi, strutture matematiche usate per modellare relazioni tra oggetti." },
        { question: "Cos'è un 'algoritmo'?", answer: "Una sequenza finita di istruzioni per risolvere un problema o eseguire un calcolo." },
        { question: "Qual è la 'congettura di Goldbach'?", answer: "Un'ipotesi non dimostrata secondo cui ogni numero pari maggiore di 2 può essere scritto come somma di due numeri primi." },
        { question: "Cosa si intende per 'teoria dei numeri'?", answer: "La branca della matematica che si occupa delle proprietà dei numeri interi." },
        { question: "Cos'è l''ultimo teorema di Fermat'?", answer: "L'affermazione, dimostrata da Andrew Wiles, che non esistono soluzioni intere positive all'equazione aⁿ + bⁿ = cⁿ per n > 2." },
        { question: "Cosa si intende per 'cardinalità' di un insieme?", answer: "Il numero di elementi di un insieme." },
        { question: "Qual è la differenza tra 'insieme finito' e 'insieme infinito'?", answer: "Un insieme finito ha un numero di elementi che può essere contato, un insieme infinito no." },
        { question: "Cosa si intende per 'logica matematica'?", answer: "Lo studio formale della logica e della sua applicazione in matematica." },
        { question: "Qual è il 'paradosso di Russell'?", answer: "Un paradosso della teoria degli insiemi che riguarda l'insieme di tutti gli insiemi che non contengono se stessi." },
        { question: "Cosa si intende per 'assioma'?", answer: "Un'affermazione considerata vera senza bisogno di dimostrazione, che serve come punto di partenza per una teoria." },
        { question: "Qual è la differenza tra 'teorema' e 'corollario'?", answer: "Un teorema è un'affermazione importante che viene dimostrata, un corollario è una conseguenza diretta di un teorema." },
        { question: "Cosa si intende per 'dimostrazione per assurdo'?", answer: "Un metodo di dimostrazione in cui si assume la negazione della tesi e si arriva a una contraddizione." },
        { question: "Cos'è un 'sistema di equazioni lineari'?", answer: "Un insieme di due o più equazioni lineari con le stesse incognite." },
        { question: "Cosa si intende per 'interpolazione'?", answer: "Stimare il valore di una funzione in un punto interno a un intervallo di cui si conoscono i valori agli estremi." },
        { question: "Qual è la differenza tra 'interpolazione' ed 'estrapolazione'?", answer: "L'interpolazione stima valori interni a un intervallo noto, l'estrapolazione stima valori esterni." },
        { question: "Cosa si intende per 'ottimizzazione'?", answer: "La ricerca del valore massimo o minimo di una funzione, soggetta a eventuali vincoli." },
        { question: "Qual è il 'metodo di Newton'?", answer: "Un algoritmo iterativo per trovare le radici di una funzione." }
      ],
      solidworks: [
        { question: "Cos'è SolidWorks?", answer: "Un software di progettazione assistita dal computer (CAD) e di ingegneria assistita dal computer (CAE)." },
        { question: "Qual è la differenza tra 'schizzo' e 'feature' (funzione)?", answer: "Lo schizzo è un profilo 2D, la feature è un'operazione 3D che modifica la forma di una parte (es. estrusione, taglio)." },
        { question: "Cosa si intende per 'progettazione parametrica'?", answer: "Un approccio in cui le dimensioni e le relazioni geometriche sono utilizzate per definire e modificare i modelli." },
        { question: "Qual è la funzione dell''estrusione base'?", answer: "Aggiungere materiale estendendo un profilo 2D lungo una direzione." },
        { question: "Cosa fa la funzione 'taglio estruso'?", answer: "Rimuovere materiale estendendo un profilo 2D per tagliare una parte." },
        { question: "A cosa serve la 'rivoluzione base'?", answer: "Creare una geometria 3D ruotando un profilo 2D attorno a un asse." },
        { question: "Cos'è un 'raccordo' (fillet)?", answer: "Un'operazione che crea un arrotondamento su uno spigolo vivo." },
        { question: "Qual è la funzione di uno 'smusso' (chamfer)?", answer: "Creare uno spigolo smussato (piatto) su un bordo." },
        { question: "Cosa si intende per 'assieme' in SolidWorks?", answer: "Un file che contiene due o più parti assemblate insieme." },
        { question: "A cosa servono gli 'accoppiamenti' (mates) in un assieme?", answer: "A definire le relazioni spaziali e i gradi di libertà tra le parti." },
        { question: "Qual è la differenza tra un accoppiamento 'coincidente' e uno 'parallelo'?", answer: "Coincidente allinea due facce o piani, parallelo li mantiene a una distanza costante." },
        { question: "Cosa si intende per 'messa in tavola' (drawing)?", answer: "La creazione di un disegno tecnico 2D a partire da un modello 3D di parte o assieme." },
        { question: "Cos'è la 'distinta materiali' (BOM - Bill of Materials)?", answer: "Un elenco di tutte le parti e i sottoassiemi che compongono un assieme." },
        { question: "A cosa serve la funzione 'sweep' (estrusione su percorso)?", answer: "Creare una forma estrudendo un profilo lungo un percorso." },
        { question: "Qual è la funzione del 'loft' (estrusione multicorpo)?", answer: "Creare una forma di transizione tra due o più profili diversi." },
        { question: "Cosa si intende per 'configurazioni'?", answer: "Variazioni di una parte o di un assieme all'interno di un singolo file." },
        { question: "A cosa serve la 'ripetizione lineare' (linear pattern)?", answer: "Creare copie multiple di una feature o di un corpo lungo una o due direzioni lineari." },
        { question: "Qual è la funzione della 'ripetizione circolare' (circular pattern)?", answer: "Creare copie multiple di una feature o di un corpo attorno a un asse." },
        { question: "Cosa si intende per 'lamiera' (sheet metal)?", answer: "Un modulo di SolidWorks per la progettazione di parti in lamiera che possono essere appiattite." },
        { question: "A cosa serve la funzione 'sviluppo' (flatten) in una parte in lamiera?", answer: "A visualizzare la parte in lamiera nel suo stato appiattito, prima della piegatura." },
        { question: "Cos'è 'SolidWorks Simulation'?", answer: "Un insieme di strumenti di analisi ad elementi finiti (FEA) per simulare il comportamento di parti e assiemi sotto carico." },
        { question: "Cosa si intende per 'analisi statica'?", answer: "Una simulazione per determinare le sollecitazioni, le deformazioni e gli spostamenti in una struttura soggetta a carichi statici." },
        { question: "Cos'è 'SolidWorks Flow Simulation'?", answer: "Un software di fluidodinamica computazionale (CFD) per analizzare il flusso di liquidi e gas." },
        { question: "A cosa serve la funzione 'specchia' (mirror)?", answer: "Creare una copia speculare di feature, facce o corpi rispetto a un piano o una faccia." },
        { question: "Qual è la differenza tra una 'parte' e un 'corpo'?", answer: "Una parte è un singolo file (.sldprt), che può contenere uno o più corpi solidi distinti." },
        { question: "Cosa si intende per 'relazioni di schizzo'?", answer: "Vincoli geometrici (es. orizzontale, verticale, tangente) che definiscono il comportamento dello schizzo." },
        { question: "Perché è importante avere uno 'schizzo completamente definito'?", answer: "Perché garantisce che la geometria sia stabile e non possa muoversi o cambiare dimensione inaspettatamente." },
        { question: "A cosa serve l' 'albero di disegno FeatureManager'?", answer: "A visualizzare la cronologia di tutte le operazioni e le feature utilizzate per creare il modello." },
        { question: "Cosa si intende per 'progettazione top-down' (dall'alto verso il basso)?", answer: "Un metodo di progettazione di assiemi in cui le parti vengono create nel contesto dell'assieme stesso." },
        { question: "Qual è il vantaggio della 'progettazione top-down'?", answer: "Permette di garantire che le parti si adattino correttamente tra loro, poiché vengono progettate in relazione l'una con l'altra." },
        { question: "Cosa si intende per 'progettazione bottom-up' (dal basso verso l'alto)?", answer: "Un metodo di progettazione in cui le parti vengono create individualmente e poi inserite in un assieme." },
        { question: "A cosa serve la 'libreria del progetto' (Design Library)?", answer: "A memorizzare e riutilizzare feature, schizzi, parti e altre entità di uso comune." },
        { question: "Cos'è 'SolidWorks PDM' (Product Data Management)?", answer: "Un sistema per la gestione dei dati di progetto, che controlla le revisioni e facilita la collaborazione." },
        { question: "A cosa serve la funzione 'shell' (svuota)?", answer: "A svuotare una parte solida, lasciando un guscio di spessore specificato." },
        { question: "Qual è la funzione del 'piano di riferimento'?", answer: "Creare un nuovo piano su cui disegnare o da usare come riferimento per altre feature." },
        { question: "A cosa serve un 'asse di riferimento'?", answer: "A creare un asse da usare per rivoluzioni, ripetizioni circolari o accoppiamenti." },
        { question: "Cosa si intende per 'rendering'?", answer: "Il processo di creazione di un'immagine fotorealistica di un modello 3D." },
        { question: "Cos'è 'PhotoView 360'?", answer: "Un componente aggiuntivo di SolidWorks per la creazione di rendering fotorealistici." },
        { question: "A cosa serve la funzione 'spline'?", answer: "A creare una curva morbida che passa attraverso una serie di punti." },
        { question: "Qual è la differenza tra 'sopprimere' e 'cancellare' una feature?", answer: "Sopprimere nasconde temporaneamente la feature, cancellare la rimuove permanentemente." },
        { question: "Cosa si intende per 'stato di visualizzazione'?", answer: "Un modo per salvare diverse combinazioni di visibilità, colore e trasparenza dei componenti in un assieme." },
        { question: "A cosa serve la 'valutazione interferenze'?", answer: "A controllare se ci sono collisioni o sovrapposizioni tra i componenti di un assieme." },
        { question: "Cos'è 'eDrawings'?", answer: "Un software gratuito per visualizzare e condividere file 2D e 3D di SolidWorks e altri formati CAD." },
        { question: "A cosa serve la funzione 'nervatura' (rib)?", answer: "A creare un sottile rinforzo strutturale all'interno di una parte." },
        { question: "Qual è la funzione del 'foro guidato' (Hole Wizard)?", answer: "Uno strumento per creare fori standard (es. filettati, svasati) in modo rapido e preciso." },
        { question: "Cosa si intende per 'filettatura cosmetica'?", answer: "Una rappresentazione grafica di una filettatura, che non ne modella la geometria effettiva per risparmiare risorse." },
        { question: "A cosa serve la funzione 'combina' (combine)?", answer: "A unire, sottrarre o trovare l'intersezione di più corpi solidi." },
        { question: "Cos'è 'SolidWorks Composer'?", answer: "Un software per creare documentazione tecnica, istruzioni di montaggio e animazioni a partire da modelli 3D." },
        { question: "A cosa serve la funzione 'sposta/copia corpo'?", answer: "A spostare, ruotare o copiare corpi solidi all'interno di un file di parte." },
        { question: "Qual è l'importanza di utilizzare 'template' personalizzati?", answer: "Permettono di standardizzare le impostazioni del documento (unità, norme di disegno, proprietà) e di risparmiare tempo." }
      ],
      robotica: [
        { question: "Quali sono i 5 livelli della piramide dell'automazione, dal basso verso l'alto?", answer: "Field Level (sensori/attuatori), Control Level (PLC), Supervisory Level (SCADA), Planning Level (MES), Management Level (ERP)." },
        { question: "Cos'è l'Intelligenza Artificiale (AI) in robotica?", answer: "È l'insieme di tecniche che permettono a una macchina di prendere decisioni in molteplici scenari, adattandosi a situazioni nuove senza una regola a priori." },
        { question: "Su cosa si basa il Reinforcement Learning (RL)?", answer: "Si basa sul concetto di apprendere facendo esperienze e ricevendo ricompense o penalità per le azioni compiute." },
        { question: "Qual è la differenza tra architettura di controllo centralizzata e decentralizzata?", answer: "Centralizzata: un server comanda tutto (semplice ma vulnerabile). Decentralizzata: ogni robot prende decisioni locali (più robusta ma richiede coordinazione)." },
        { question: "Cosa studia l'HRI (Human Robot Interaction)?", answer: "Studia come le persone interagiscono con i robot, includendo aspetti tecnici, psicologici e sociali." },
        { question: "Cos'è un PLC (Programmable Logic Controller)?", answer: "Un computer digitale industriale robusto, progettato per eseguire cicli di controllo in tempo reale in ambienti difficili." },
        { question: "Qual è la differenza tra sistemi Hard Real-Time e Soft Real-Time?", answer: "In Hard RT, mancare una deadline è un errore critico (safety-critical). In Soft RT, porta a un degrado di qualità ma non al collasso del sistema." },
        { question: "Qual è il problema della cinematica diretta?", answer: "Data una configurazione dei giunti, determinare la posa (posizione e orientamento) dell'end-effector. È un problema sempre risolvibile." },
        { question: "Qual è il problema della cinematica inversa?", answer: "Data una posa desiderata dell'end-effector, determinare i valori dei giunti. È un problema complesso che può avere nessuna, una o più soluzioni." },
        { question: "Cos'è una 'singolarità' di un manipolatore?", answer: "Una configurazione in cui il robot perde gradi di libertà, causando movimenti imprevedibili o bloccandosi. Va evitata nella pianificazione del moto." },
        { question: "Quale tecnologia è emersa come chiave per l'industria nel periodo 1970-1990?", answer: "PLC e robot rigidi, con una priorità su qualità e stabilità della produzione." },
        { question: "Quali sono le tecnologie abilitanti dell'era 2010-2025?", answer: "AI, IoT (Internet of Things) e Digital Twin, con focus su digitalizzazione e autonomia dei processi." },
        { question: "A cosa serve il livello MES (Manufacturing Execution System)?", answer: "Serve al livello esecutivo per gestire ordini di produzione e raccolta dati in tempo reale." },
        { question: "Cos'è la Computer Vision?", answer: "È la disciplina che consente ai robot di 'vedere' e interpretare immagini o video per dedurne un comportamento." },
        { question: "Cos'è un sistema distribuito in robotica?", answer: "Un insieme di robot o nodi che lavorano insieme, senza un unico punto di controllo, per completare una task complessa." },
        { question: "Qual è l'obiettivo della normativa ISO/TS 15066?", answer: "Garantire che l'interazione fisica uomo-robot (nei cobot) avvenga senza rischio di lesioni, definendo le modalità di collaborazione sicura." },
        { question: "Quali sono le 4 modalità di collaborazione sicura per i cobot?", answer: "Safety-rated monitored stop (SRMS), Hand guiding, Speed and separation monitoring (SSM), e Power and force limiting (PFL)." },
        { question: "Qual è la differenza tra un Embedded System e un Bus System in ambito hardware?", answer: "Embedded: funzione dedicata, non espandibile, per grandi volumi. Bus System: architettura modulare ed espandibile, più flessibile, per piccole serie." },
        { question: "Quali sono le tre fasi del ciclo di scanning di un PLC?", answer: "1. Input Scan (lettura sensori), 2. Program Scan (esecuzione logica), 3. Output Scan (scrittura attuatori)." },
        { question: "Cos'è il Jitter in un sistema Real-Time?", answer: "È la variabilità del tempo di completamento di un task periodico. Deve essere minimizzata per garantire il determinismo." },
        { question: "Qual è la differenza tra Percorso (Path) e Traiettoria (Trajectory)?", answer: "Il Percorso è la forma geometrica del movimento. La Traiettoria è il percorso associato a una legge oraria (un profilo di velocità nel tempo)." },
        { question: "Cosa significa che un manipolatore è 'ridondante'?", answer: "Significa che ha più gradi di libertà (n) rispetto a quelli richiesti dallo spazio di lavoro (m), n > m. Questo aumenta la flessibilità." },
        { question: "Quali sono i vantaggi di un robot Cartesiano (TTT)?", answer: "Elevata precisione e rigidità, e controllo semplice delle traiettorie." },
        { question: "Per cosa è tipicamente usato un robot SCARA (RRT)?", answer: "Per assemblaggio elettronico e movimentazione rapida su un piano orizzontale, grazie alla sua elevata velocità nei movimenti planari." },
        { question: "Perché il controllo di interazione è fondamentale in molte applicazioni?", answer: "Perché il robot non deve solo seguire un percorso, ma anche interagire con l'ambiente, ad esempio mantenendo una forza costante." },
        { question: "Qual è la differenza tra controllo di ammettenza e controllo di forza diretto?", answer: "Ammettenza (indiretto): regola la posizione in risposta a forze esterne. Forza diretto: regola direttamente le coppie/forze applicate ai giunti." },
        { question: "Cos'è un Digital Twin?", answer: "È un modello virtuale che replica fedelmente un robot o una linea di produzione, usato per simulazioni, monitoraggio e manutenzione predittiva." },
        { question: "Quali sono i componenti fondamentali di un sistema di controllo industriale?", answer: "Acquisizione dati (sensori), Microprocessore, Interfaccia di uscita (attuatori), Timer e Interfacce di comunicazione." },
        { question: "Cosa si intende per HMI (Human-Machine Interface)?", answer: "L'interfaccia software/hardware che permette l'interazione tra operatore umano e sistema automatico (robot, macchine, ecc.)." },
        { question: "Quali sono le proprietà chiave di un sistema usabile secondo la ISO 9241?", answer: "Efficacia (Effectiveness), Efficienza (Efficiency) e Soddisfazione (Satisfaction)." },
        { question: "Qual è la differenza tra un manipolatore 'difettivo' e uno 'ridondante'?", answer: "Difettivo: ha meno gradi di libertà (DOF) dello spazio di lavoro (n < m). Ridondante: ha più DOF (n > m), aumentando la flessibilità." },
        { question: "Qual è lo spazio di lavoro di un robot cartesiano (TTT)?", answer: "Un parallelepipedo." },
        { question: "Qual è lo spazio di lavoro di un robot SCARA (RRT)?", answer: "Un cilindro appiattito." },
        { question: "Qual è lo spazio di lavoro di un robot antropomorfo a 6 DOF?", answer: "Una sfera deformata e molto ampia." },
        { question: "Come funziona il controllo di un robot 'uniciclo' (differential drive)?", answer: "Usa due ruote attuate indipendentemente. Il moto rettilineo si ottiene con velocità uguali (wR = wL), la rotazione sul posto con velocità opposte (wR = -wL)." },
        { question: "Qual è il principale svantaggio di un robot 'triciclo' (car-like)?", answer: "Agilità limitata e necessità di manovre complesse, simili a un'automobile." },
        { question: "Perché si usano i 'via-points' nella pianificazione del movimento?", answer: "Per interpolare un percorso complesso, evitando ostacoli e rispettando i vincoli cinematici del robot (velocità, accelerazione)." },
        { question: "Come funziona l'algoritmo di pianificazione PRM (Probabilistic Roadmap)?", answer: "Campiona configurazioni casuali, scarta quelle in collisione, costruisce un grafo (roadmap) dei punti validi e cerca un percorso." },
        { question: "Qual è il ruolo dell'azionamento elettrico (drive) nella catena di controllo del moto?", answer: "Regola la coppia del motore (anello di corrente) per seguire i riferimenti forniti dal controllore di posizione/velocità." },
        { question: "Perché un profilo di moto con discontinuità del jerk è problematico?", answer: "Perché la discontinuità del jerk (derivata dell'accelerazione) può causare urti e vibrazioni meccaniche indesiderate." },
        { question: "Quali sono le 4 proprietà chiave di un sistema usabile (oltre efficacia, efficienza, soddisfazione)?", answer: "Learnability (facile da imparare), Memorability (facile da ricordare), Errori ridotti e Sicurezza." },
        { question: "Quali sono le tecnologie principali per l'uso del Natural Language Processing (NLP) in robotica?", answer: "NLP per interpretare comandi, Speech-to-Text/Text-to-Speech per la traduzione vocale, e Gesture recognition per i gesti." },
        { question: "Cos'è l'Industrial IoT (IIoT)?", answer: "È l'applicazione dell'IoT in ambito industriale, dove robot, macchine e sensori comunicano tra loro per creare una fabbrica connessa." },
        { question: "Quali sono i principali protocolli di comunicazione per l'IIoT?", answer: "OPC-UA (standard per macchinari), MQTT (leggero per dispositivi IoT) e 5G (bassa latenza per robot mobili)." },
        { question: "Qual è la differenza tra Edge Computing e Cloud Computing?", answer: "Edge: elaborazione dati vicino alla macchina per risposte rapide. Cloud: analisi pesanti, archiviazione e AI." },
        { question: "Cosa sono le 'sezioni critiche' in programmazione concorrente?", answer: "Sono blocchi di codice che accedono a risorse condivise e che devono essere eseguiti in modo atomico per evitare race condition." },
        { question: "Cos'è un 'semaforo' in programmazione?", answer: "È una primitiva di sincronizzazione per gestire l'accesso a risorse condivise, prevenendo l'uso simultaneo da parte di più task." },
        { question: "Qual è il ruolo dello scheduler in un RTOS (Real-Time Operating System)?", answer: "Decide quale task eseguire in base a politiche specifiche (es. priorità, round-robin) per rispettare le deadline temporali." },
        { question: "Cosa si intende per 'catena cinematica'?", answer: "L'insieme di link (corpi rigidi) e giunti (motori) che convertono il moto dei giunti nel movimento dell'end-effector." },
        { question: "Qual è la tecnologia abilitante dell'era industriale 1950-1970?", answer: "La Meccanizzazione, con priorità su quantità ed efficienza e un modello produttivo Push." }
      ],
      programmazione: [
        { question: "Cos'è un 'algoritmo'?", answer: "Una sequenza finita di istruzioni chiare e non ambigue per risolvere un problema o eseguire un calcolo." },
        { question: "Qual è la differenza tra 'programmazione compilata' e 'interpretata'?", answer: "Compilata: il codice sorgente viene tradotto in codice macchina prima dell'esecuzione. Interpretata: il codice viene tradotto ed eseguito riga per riga da un interprete." },
        { question: "Cosa si intende per 'variabile'?", answer: "Un contenitore di dati nominato che può contenere un valore che può cambiare durante l'esecuzione del programma." },
        { question: "Quali sono i principali 'tipi di dati' primitivi?", answer: "Interi (int), numeri in virgola mobile (float), booleani (bool) e caratteri (char)." },
        { question: "Cos'è un 'ciclo' (loop)?", answer: "Una struttura di controllo che ripete un blocco di codice finché una condizione specificata rimane vera." },
        { question: "Qual è la differenza tra un ciclo 'for' e un ciclo 'while'?", answer: "Il ciclo 'for' è usato quando il numero di iterazioni è noto, il 'while' quando la condizione di terminazione dipende da altri fattori." },
        { question: "Cosa si intende per 'struttura condizionale' (if-else)?", answer: "Una struttura che esegue blocchi di codice diversi a seconda che una condizione sia vera o falsa." },
        { question: "Cos'è una 'funzione' o 'metodo'?", answer: "Un blocco di codice riutilizzabile che esegue un'attività specifica. Può accettare parametri e restituire un valore." },
        { question: "Cosa si intende per 'programmazione orientata agli oggetti' (OOP)?", answer: "Un paradigma di programmazione basato sul concetto di 'oggetti', che possono contenere dati (attributi) e codice (metodi)." },
        { question: "Cos'è una 'classe' in OOP?", answer: "Un modello o 'stampo' per creare oggetti. Definisce gli attributi e i metodi che gli oggetti di quella classe avranno." },
        { question: "Qual è la differenza tra 'classe' e 'oggetto'?", answer: "La classe è il progetto (es. il progetto di un'auto), l'oggetto è un'istanza concreta di quella classe (es. la mia auto)." },
        { question: "Cosa si intende per 'ereditarietà'?", answer: "Un meccanismo OOP in cui una classe (sottoclasse) può ereditare attributi e metodi da un'altra classe (superclasse)." },
        { question: "Cos'è il 'polimorfismo'?", answer: "La capacità di oggetti di classi diverse di rispondere allo stesso messaggio (chiamata di metodo) in modi specifici per la loro classe." },
        { question: "Cosa si intende per 'incapsulamento'?", answer: "Il raggruppamento di dati e metodi che operano su quei dati in un'unica unità (un oggetto), nascondendo i dettagli interni." },
        { question: "Cos'è un 'array' o 'vettore'?", answer: "Una struttura dati che memorizza una collezione di elementi dello stesso tipo in posizioni di memoria contigue." },
        { question: "Qual è la differenza tra 'stack' e 'queue'?", answer: "Stack (pila) è LIFO (Last-In, First-Out). Queue (coda) è FIFO (First-In, First-Out)." },
        { question: "Cosa si intende per 'ricorsione'?", answer: "Una tecnica in cui una funzione chiama se stessa per risolvere un problema, suddividendolo in sotto-problemi più piccoli." },
        { question: "Cos'è un 'database'?", answer: "Una raccolta organizzata di dati, gestita da un sistema chiamato DBMS (Database Management System)." },
        { question: "Qual è la differenza tra 'SQL' e 'NoSQL'?", answer: "SQL è per database relazionali con schemi fissi (tabelle). NoSQL è per database non relazionali con schemi flessibili (documenti, grafi, ecc.)." },
        { question: "Cosa si intende per 'API' (Application Programming Interface)?", answer: "Un insieme di regole e strumenti che permette a diverse applicazioni software di comunicare tra loro." },
        { question: "Cos'è 'Git'?", answer: "Un sistema di controllo di versione distribuito, usato per tracciare le modifiche al codice sorgente durante lo sviluppo del software." },
        { question: "Qual è la differenza tra 'HTTP' e 'HTTPS'?", answer: "HTTPS è la versione sicura di HTTP. Utilizza la crittografia (SSL/TLS) per proteggere i dati scambiati tra client e server." },
        { question: "Cosa si intende per 'debugging'?", answer: "Il processo di individuazione e correzione di errori (bug) in un programma." },
        { question: "Cos'è un 'framework'?", answer: "Una struttura software che fornisce una base su cui gli sviluppatori possono costruire applicazioni, offrendo funzionalità generiche." },
        { question: "Qual è la differenza tra 'libreria' e 'framework'?", answer: "Una libreria è una collezione di funzioni che il tuo codice chiama. Un framework è una struttura che chiama il tuo codice (Inversion of Control)." },
        { question: "Cos'è la 'complessità computazionale' di un algoritmo?", answer: "Una misura delle risorse (tempo e spazio) richieste dall'algoritmo in funzione della dimensione dell'input." },
        { question: "Qual è la differenza tra 'passaggio per valore' e 'passaggio per riferimento'?", answer: "Per valore: viene passata una copia del valore della variabile. Per riferimento: viene passato l'indirizzo di memoria della variabile, permettendo di modificarla." },
        { question: "Cos'è un 'puntatore'?", answer: "Una variabile che memorizza l'indirizzo di memoria di un'altra variabile." },
        { question: "Cosa si intende per 'allocazione dinamica della memoria'?", answer: "L'allocazione di memoria per le variabili durante l'esecuzione del programma, invece che a tempo di compilazione." },
        { question: "Cos'è il 'garbage collector'?", answer: "Un processo automatico che libera la memoria occupata da oggetti che non sono più utilizzati dal programma." },
        { question: "Qual è la differenza tra 'JSON' e 'XML'?", answer: "JSON (JavaScript Object Notation) è più leggero e facile da leggere per gli umani. XML (eXtensible Markup Language) è più verboso e usa tag di chiusura." },
        { question: "Cos'è un 'IDE' (Integrated Development Environment)?", answer: "Un software che fornisce strumenti completi per lo sviluppo, come editor di codice, debugger e compilatore." },
        { question: "Cosa si intende per 'testing unità' (unit testing)?", answer: "Il processo di testare singole unità o componenti di un software per verificare che funzionino correttamente in isolamento." },
        { question: "Qual è lo scopo di un 'ciclo di vita dello sviluppo del software' (SDLC)?", answer: "Fornire un processo strutturato per la produzione di software di alta qualità, dal concepimento al rilascio e manutenzione." },
        { question: "Cos'è il 'modello a cascata' (waterfall model)?", answer: "Un modello SDLC sequenziale in cui ogni fase (requisiti, progettazione, implementazione, test) deve essere completata prima di passare alla successiva." },
        { question: "Cos'è la 'metodologia Agile'?", answer: "Un approccio iterativo e incrementale allo sviluppo software che si concentra sulla collaborazione, il feedback del cliente e rilasci frequenti." },
        { question: "Cos'è 'Scrum'?", answer: "Un framework Agile per la gestione di progetti complessi, basato su cicli di sviluppo brevi chiamati 'sprint'." },
        { question: "Cosa si intende per 'refactoring'?", answer: "Il processo di ristrutturazione del codice sorgente esistente senza cambiarne il comportamento esterno, per migliorarne la leggibilità e la manutenibilità." },
        { question: "Cos'è un 'design pattern'?", answer: "Una soluzione generale e riutilizzabile a un problema comune nel contesto della progettazione del software." },
        { question: "Qual è il pattern 'Singleton'?", answer: "Un design pattern che garantisce che una classe abbia una sola istanza e fornisce un punto di accesso globale a tale istanza." },
        { question: "Qual è il pattern 'Factory'?", answer: "Un design pattern che fornisce un'interfaccia per creare oggetti in una superclasse, ma permette alle sottoclassi di alterare il tipo di oggetti che verranno creati." },
        { question: "Cosa si intende per 'concorrenza' in programmazione?", answer: "La capacità di un sistema di eseguire più calcoli o processi contemporaneamente, che possono o meno interagire tra loro." },
        { question: "Qual è la differenza tra 'concorrenza' e 'parallelismo'?", answer: "La concorrenza è la gestione di più task alla volta (task switching). Il parallelismo è l'esecuzione effettiva di più task simultaneamente (su più core)." },
        { question: "Cos'è un 'thread'?", answer: "La più piccola unità di esecuzione che può essere gestita in modo indipendente da uno scheduler." },
        { question: "Cos'è un 'mutex' (mutua esclusione)?", answer: "Un meccanismo di sincronizzazione per prevenire che più thread accedano contemporaneamente a una risorsa condivisa." },
        { question: "Cosa si intende per 'deadlock'?", answer: "Una situazione in cui due o più processi sono bloccati in attesa l'uno dell'altro, impedendo a entrambi di proseguire." },
        { question: "Cos'è la 'programmazione funzionale'?", answer: "Un paradigma di programmazione che tratta il calcolo come la valutazione di funzioni matematiche ed evita di cambiare lo stato e i dati mutabili." },
        { question: "Cos'è una 'lambda function' o 'funzione anonima'?", answer: "Una funzione definita senza un nome, spesso usata per brevi operazioni o come argomento di funzioni di ordine superiore." },
        { question: "Cosa si intende per 'sicurezza dei tipi' (type safety)?", answer: "La misura in cui un linguaggio di programmazione previene o scoraggia errori di tipo, ovvero operazioni su dati di tipo errato." },
        { question: "Cos'è 'Unicode'?", answer: "Uno standard di codifica dei caratteri che mira a rappresentare tutti i caratteri utilizzati in quasi tutte le lingue scritte del mondo." }
      ]
    };

    const backgroundImages = {
      meccanica: 'https://images.pexels.com/photos/716661/pexels-photo-716661.jpeg?auto=compress&cs=tinysrgb&w=1920&q=60',
      sicurezza: 'https://images.pexels.com/photos/209230/pexels-photo-209230.jpeg?auto=compress&cs=tinysrgb&w=1920&q=60',
      elettrotecnica: 'https://images.pexels.com/photos/6477203/pexels-photo-6477203.jpeg?auto=compress&cs=tinysrgb&w=1920&q=60',
      comunicazione: 'https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1920&q=60',
      matematica: 'https://images.pexels.com/photos/3729557/pexels-photo-3729557.jpeg?auto=compress&cs=tinysrgb&w=1920&q=60',
      solidworks: 'https://images.pexels.com/photos/7504612/pexels-photo-7504612.jpeg?auto=compress&cs=tinysrgb&w=1920&q=60',
      robotica: 'https://images.pexels.com/photos/8386440/pexels-photo-8386440.jpeg?auto=compress&cs=tinysrgb&w=1920&q=60',
      programmazione: 'https://images.pexels.com/photos/577585/pexels-photo-577585.jpeg?auto=compress&cs=tinysrgb&w=1920&q=60',
      qualifica: 'https://images.pexels.com/photos/1181298/pexels-photo-1181298.jpeg?auto=compress&cs=tinysrgb&w=1920&q=60'
    };

    // --- Configurazione Immagini Cicliche per la Home ---
    const homeCycleImages = Object.values(backgroundImages);
    // --- Fine Configurazione Immagini Cicliche ---


    const bgContainer = document.getElementById('background-container');
    const bgOverlay = document.getElementById('background-overlay');
    const staticBackground = document.getElementById('static-background');
    const carouselContainer = document.getElementById('image-carousel');
    const sidebar = document.getElementById('sidebar');
    const mainContent = document.getElementById('main-content');
    const menuToggle = document.getElementById('menu-toggle');
    const overlay = document.getElementById('overlay');
    const homeScreen = document.getElementById('home-screen');
    const subjectScreen = document.getElementById('subject-screen');
    const quizScreen = document.getElementById('quiz-screen');
    const resultsScreen = document.getElementById('results-screen');

    // Riferimenti pulsanti e elementi del Quiz/Flashcard
    const subjectTitle = document.getElementById('subject-title'); // Riferimento al nuovo H2
    const flipbookBtn = document.getElementById('flipbook-btn');
    const flashcardBtn = document.getElementById('flashcard-btn');
    const flashcard = document.getElementById('flashcard');
    const questionText = document.getElementById('question-text');
    const answerText = document.getElementById('answer-text');
    const progressText = document.getElementById('progress-text');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const resultsMessage = document.getElementById('results-message');


    // Variabile per gestire il ciclo dello sfondo automatico
    let homeBackgroundInterval = null;
    let currentHomeImageIndex = 0;

    // Costante CSS per l'effetto blur
    const BLURRED_CLASS = 'blurred-overlay';
    // Costante CSS per lo shift del contenuto principale su desktop
    const SHIFTED_CLASS = 'main-content-shifted';
    // Classe per rendere l'overlay trasparente su desktop (gestita in JS/CSS)
    const DESKTOP_TRANSPARENT_CLASS = 'desktop-transparent';

    /**
     * Controlla se lo schermo è in modalità desktop (larghezza >= 768px).
     */
    const isDesktop = () => window.matchMedia('(min-width: 768px)').matches;


    /**
     * Inietta i div delle immagini nel carosello una sola volta.
     */
    function initializeHomeCarousel() {
        if (carouselContainer.children.length === 0) {
            homeCycleImages.forEach((url, index) => {
                const div = document.createElement('div');
                div.className = 'carousel-image';
                div.style.backgroundImage = `url('${url}')`;
                div.dataset.index = index;
                carouselContainer.appendChild(div);
            });
        }
    }


    /**
     * Avvia il ciclo di cambio dello sfondo della Home con transizione a dissolvenza (fade).
     */
    function startHomeBackgroundCycle() {
        if (homeBackgroundInterval) {
            clearInterval(homeBackgroundInterval);
        }

        const images = Array.from(carouselContainer.children);
        if (images.length === 0) return;

        images.forEach(img => {
            img.classList.remove('active');
        });

        currentHomeImageIndex = Math.floor(Math.random() * images.length);
        images[currentHomeImageIndex].classList.add('active');


        homeBackgroundInterval = setInterval(() => {
            const prevIndex = currentHomeImageIndex;
            let nextIndex;
            do {
                nextIndex = Math.floor(Math.random() * homeCycleImages.length);
            } while (nextIndex === currentHomeImageIndex);

            const currentImage = images[prevIndex];
            const nextImage = images[nextIndex];

            currentImage.classList.remove('active');
            nextImage.classList.add('active');

            currentHomeImageIndex = nextIndex;

        }, 5000); // Intervallo a 5 secondi
    }

    /**
     * Ferma il ciclo di cambio dello sfondo della Home.
     */
    function stopHomeBackgroundCycle() {
        if (homeBackgroundInterval) {
            clearInterval(homeBackgroundInterval);
            homeBackgroundInterval = null;
        }
        Array.from(carouselContainer.children).forEach(img => {
            img.classList.remove('active');
        });
    }


    function clearActiveSidebar() {
      const items = document.querySelectorAll('.sidebar-item');
      items.forEach(item => {
        item.classList.remove('active');
      });
    }

    function markActiveSidebar(subjectId) {
      clearActiveSidebar();
      const item = document.getElementById(`item-${subjectId}`);
      if (item) item.classList.add('active');
    }

    /**
     * Gestisce il cambio di sfondo principale, mostrando le immagini statiche o attivando il carosello.
     */
    function changeBackground(subjectKey) {
      const needsBlur = (subjectKey !== 'home');

      // Gestione Blur dell'overlay
      if (needsBlur) {
          bgOverlay.classList.add(BLURRED_CLASS);
      } else {
          bgOverlay.classList.remove(BLURRED_CLASS);
      }

      // Gestione Carosello vs Sfondo Statico
      if (subjectKey === 'home') {
          // Attiva il carosello e nasconde lo sfondo statica
          staticBackground.style.opacity = 0;
          carouselContainer.style.display = 'block';
          startHomeBackgroundCycle();
      } else {
          // Disattiva il carosello e mostra lo sfondo statico
          stopHomeBackgroundCycle();
          carouselContainer.style.display = 'none';

          const newImageUrl = backgroundImages[subjectKey];

          // Transizione per immagini statiche
          if (bgContainer.dataset.currentKey !== subjectKey) {
              staticBackground.style.opacity = 0;
              setTimeout(() => {
                staticBackground.style.backgroundImage = `url('${newImageUrl}')`;
                staticBackground.style.opacity = 1;
              }, 100);
          } else {
              staticBackground.style.opacity = 1;
          }
      }

      bgContainer.dataset.currentKey = subjectKey;
    }


    // --- Funzioni di Navigazione e Sidebar ---
    function isSidebarOpen() {
        // Controlla se la sidebar ha la classe 'sidebar-open'
        return sidebar.classList.contains('sidebar-open');
    }

    function toggleSidebar() {
        const isOpen = isSidebarOpen();
        const shouldOpen = !isOpen; // Stiamo tentando di aprire?



        // 1. Toggle delle classi della Sidebar
        sidebar.classList.toggle('sidebar-open', shouldOpen);
        sidebar.classList.toggle('-translate-x-full', isOpen);

        // 2. Toggle del margine del Contenuto Principale
        mainContent.classList.toggle(SHIFTED_CLASS, shouldOpen);

        // 3. Toggle dell'Overlay (adesso è sempre attivo quando la sidebar è aperta)
        overlay.classList.toggle('hidden', isOpen);

        // 4. Gestione Trasparenza Overlay (per il click fuori su desktop)
        if (shouldOpen && isDesktop()) {
            // L'overlay è trasparente su desktop ma rimane visibile
            overlay.classList.add(DESKTOP_TRANSPARENT_CLASS);
        } else if (isOpen) {
            overlay.classList.remove(DESKTOP_TRANSPARENT_CLASS);
        }


    }

    /**
     * Chiude la sidebar forzatamente. Utilizzata per i click interni.
     */
    function closeSidebar() {
        if (isSidebarOpen()) {
            toggleSidebar(); // La funzione toggle esegue la chiusura se è aperta
        }
    }


    menuToggle.addEventListener('click', toggleSidebar);

    overlay.addEventListener('click', closeSidebar);


    function showHomeScreen() {
        // Provide immediate feedback by closing the sidebar
        closeSidebar();
        // Defer the heavy work to the next event loop cycle
        setTimeout(setupAndShowHomeScreen, 50);
    }

    function setupAndShowHomeScreen() {
      changeBackground('home');
      subjectScreen.classList.add('hidden');
      quizScreen.classList.add('hidden');
      resultsScreen.classList.add('hidden');
      document.getElementById('real-quiz-screen').classList.add('hidden');
      document.getElementById('real-quiz-results-screen').classList.add('hidden');

      const homeScreenDiv = document.getElementById('home-screen');
      const subtitle = document.getElementById('home-subtitle');
      const verticalTitle = document.getElementById('home-vertical-title');
      const words = [
          document.getElementById('word-tecnico'),
          document.getElementById('word-automazione'),
          document.getElementById('word-industriale')
      ];

      // Select a random quote
      const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
      subtitle.innerHTML = `"${randomQuote.text}"<br><span class="text-sm font-normal">- ${randomQuote.author}</span>`;

      // Reset animations
      homeScreenDiv.classList.remove('hidden');
      subtitle.classList.remove('fade-in-4s', 'fade-out-1s', 'fade-in-5s');
      subtitle.style.opacity = '0';

      // Reset title container and words
      verticalTitle.style.opacity = '0';
      words.forEach(word => {
        if(word) {
            word.style.opacity = 0; // Start hidden
            word.style.animation = ''; // Clear any previous animation
        }
      });

      // --- Start Animation Sequence ---

      // 1. Subtitle fades in
      setTimeout(() => {
        subtitle.classList.add('fade-in-5s');
      }, 100);

      // 2. After 5s, subtitle starts to fade out
      setTimeout(() => {
        subtitle.classList.remove('fade-in-5s');
        subtitle.classList.add('fade-out-1s');
      }, 5100); // 5s fade-in + 0.1s buffer

      // 3. After 6.1s, show vertical title by animating words
      setTimeout(() => {
        verticalTitle.style.opacity = '1'; // Show the container

        const animations = ['fadeInUp', 'fadeInLeft', 'zoomIn'];

        words.forEach((word, index) => {
            if (word) {
                const randomAnimation = animations[Math.floor(Math.random() * animations.length)];
                word.style.animation = `${randomAnimation} 0.8s ease-out forwards`;
                word.style.animationDelay = `${index * 0.4}s`;
            }
        });
      }, 6200); // 5.1s + 1s fade-out + 0.1s buffer

      // 4. After title animation, blink arrow
      setTimeout(() => {
          menuToggle.style.opacity = 1;
          menuToggle.style.pointerEvents = 'auto';
          menuToggle.classList.add('blink-red-twice');

          setTimeout(() => {
            menuToggle.style.opacity = 0;
            menuToggle.style.pointerEvents = 'none';
            menuToggle.classList.remove('blink-red-twice');
          }, 1000);
      }, 7800);

      clearActiveSidebar();
    }

    let currentQuizData = [];
    let currentQuestionIndex = 0;
    let isFlipped = false;
    let currentSubjectInfo = {};

    const realQuizScreen = document.getElementById('real-quiz-screen');
    let currentRealQuizData = [];
    let currentRealQuizIndex = 0;
    let score = 0;

    const subjectData = {
      meccanica: { name: 'Progettazione Meccanica', flipbook: 'https://www.calameo.com/read/0080586702a2803aacd1a' },
      sicurezza: { name: 'Sicurezza sul Lavoro', flipbook: 'https://www.calameo.com/read/0080586704ac279277422' },
      elettrotecnica: { name: 'Elettrotecnica', flipbook: 'https://www.calameo.com/read/0080586706f297b0b127f' },
      comunicazione: { name: 'Soft Skills & Comunicazione', flipbook: 'https://www.calameo.com/read/0080586704d243157c399' },
      matematica: { name: 'Matematica', flipbook: 'https://www.calameo.com/account/private/read/#code-0080586707940de0f2426' },
      solidworks: { name: 'Solidworks', flipbook: 'https://www.calameo.com/read/0080586708c1eaef6408f' },
      robotica: { name: 'Robotica', flipbook: 'https://www.calameo.com/read/008058670c3c6f838af83' },
      programmazione: { name: 'Programmazione Informatica', flipbook: 'https://www.calameo.com/read/00805867000fffa431632' },
    };



    function prepareAndStart(subjectId, type) {
        const subject = subjectData[subjectId];
        if (!subject) return;

        currentSubjectInfo = {
            subjectId: subjectId,
            subjectName: subject.name,
            flipbookUrl: subject.flipbook
        };

        // Defer all UI updates to free the main thread immediately after click
        setTimeout(() => {
            closeSidebar();
            changeBackground(subjectId);

            // Hide all main screens
            homeScreen.classList.add('hidden');
            quizScreen.classList.add('hidden');
            realQuizScreen.classList.add('hidden');
            resultsScreen.classList.add('hidden');
            document.getElementById('real-quiz-results-screen').classList.add('hidden');

            if (type === 'flashcard') {
                startQuiz(subjectId);
            } else if (type === 'realQuiz') {
                startRealQuiz(subjectId);
            }
        }, 0); // Yield to main thread immediately
    }

    function startQuiz(subjectId) {
      document.getElementById('presenze-screen').classList.add('hidden');
      stopHomeBackgroundCycle();
      bgOverlay.classList.add(BLURRED_CLASS);

      if (!questions[subjectId] || questions[subjectId].length === 0) {
        currentQuizData = [];
      } else {
        currentQuizData = [...questions[subjectId]].sort(() => Math.random() - 0.5);
      }
      currentQuestionIndex = 0;
      isFlipped = false;
      flashcard.classList.remove('flipped');
      subjectScreen.classList.add('hidden');
      resultsScreen.classList.add('hidden');
      quizScreen.classList.remove('hidden');
      displayQuestion();
    }

    function displayQuestion() {
      if (isFlipped) {
        flashcard.classList.remove('flipped');
        isFlipped = false;
      }
      if (!currentQuizData || currentQuizData.length === 0) {
        questionText.innerText = 'Nessuna domanda disponibile per questa materia.';
        answerText.innerText = 'Seleziona un\'altra materia o aggiungi domande.';
        progressText.innerText = '';
        prevBtn.disabled = true;
        nextBtn.disabled = true;
        return;
      }
      const questionData = currentQuizData[currentQuestionIndex];
      questionText.innerText = questionData.question || '';
      answerText.innerText = questionData.answer || '';
      progressText.innerText = `Domanda ${currentQuestionIndex + 1} di ${currentQuizData.length}`;
      prevBtn.disabled = (currentQuestionIndex === 0);
      nextBtn.disabled = (currentQuestionIndex === currentQuizData.length - 1);
    }

    function flipCard() {
      if (currentQuizData && currentQuizData.length > 0) {
        flashcard.classList.toggle('flipped');
        isFlipped = !isFlipped;
      }
    }

    function nextQuestion() {
      if (currentQuestionIndex < currentQuizData.length - 1) {
        currentQuestionIndex++;
        displayQuestion();
      } else {
        showResults();
      }
    }

    function previousQuestion() {
      if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        displayQuestion();
      }
    }

    function showResults() {
      quizScreen.classList.add('hidden');
      resultsScreen.classList.remove('hidden');
      resultsMessage.innerText = `Sessione di studio completata! Hai completato tutte le flashcard per ${currentSubjectInfo.subjectName}. Ottimo lavoro!`;
    }

    function restartQuiz() {
      if (!resultsScreen.classList.contains('hidden')) {
          startQuiz(currentSubjectInfo.subjectId);
      }
    }

    function startRealQuiz(subjectId) {
      document.getElementById('presenze-screen').classList.add('hidden');
        stopHomeBackgroundCycle();
        bgOverlay.classList.add(BLURRED_CLASS);

        const subjectQs = questions[subjectId];
        if (!subjectQs || subjectQs.length < 50) {
            alert("Questa materia non ha abbastanza domande per un quiz da 50.");
            return;
        }

        homeScreen.classList.add('hidden');
        subjectScreen.classList.add('hidden');
        quizScreen.classList.add('hidden');
        resultsScreen.classList.add('hidden');
        const realQuizResultsScreen = document.getElementById('real-quiz-results-screen');
        if(realQuizResultsScreen) {
            realQuizResultsScreen.classList.add('hidden');
        }

        currentRealQuizData = [...subjectQs].sort(() => Math.random() - 0.5).slice(0, 50);
        currentRealQuizIndex = 0;
        score = 0;
        realQuizScreen.classList.remove('hidden');
        document.getElementById('real-quiz-subject-title').innerText = `Quiz: ${currentSubjectInfo.subjectName}`;
        document.getElementById('real-quiz-score').innerText = `Punteggio: 0`;
        displayQuizQuestion();
    }

    function displayQuizQuestion() {
        const quizProgress = document.getElementById('real-quiz-progress');
        const quizQuestion = document.getElementById('real-quiz-question');
        const quizAnswers = document.getElementById('real-quiz-answers');
        const nextQuizBtn = document.getElementById('next-quiz-btn');

        nextQuizBtn.classList.add('hidden');
        quizAnswers.innerHTML = '';

        if (currentRealQuizIndex >= currentRealQuizData.length) {
            showQuizResults();
            return;
        }

        quizProgress.innerText = `Domanda ${currentRealQuizIndex + 1} di ${currentRealQuizData.length}`;
        const questionData = currentRealQuizData[currentRealQuizIndex];
        quizQuestion.innerText = questionData.question;

        const correctAnswer = questionData.answer;
        const allAnswers = [...new Set(questions[currentSubjectInfo.subjectId].map(q => q.answer))];
        let incorrectAnswers = allAnswers.filter(a => a !== correctAnswer).sort(() => Math.random() - 0.5).slice(0, 3);
        while (incorrectAnswers.length < 3) {
            incorrectAnswers.push(`Risposta errata ${incorrectAnswers.length + 1}`);
        }
        const answerOptions = [correctAnswer, ...incorrectAnswers].sort(() => Math.random() - 0.5);

        answerOptions.forEach(answer => {
            const button = document.createElement('button');
            button.className = 'p-4 rounded-lg text-left transition-colors duration-200 text-white bg-gray-800 hover:bg-gray-700';
            button.innerText = answer;
            button.onclick = () => selectQuizAnswer(button, answer === correctAnswer);
            quizAnswers.appendChild(button);
        });
    }

    function selectQuizAnswer(button, isCorrect) {
        const quizAnswers = document.getElementById('real-quiz-answers');
        const nextQuizBtn = document.getElementById('next-quiz-btn');

        Array.from(quizAnswers.children).forEach(btn => {
            btn.disabled = true;
            const answerText = btn.innerText;
            const originalQuestion = currentRealQuizData[currentRealQuizIndex];
            if (answerText === originalQuestion.answer) {
                btn.className = 'p-4 rounded-lg text-left transition-colors duration-200 text-white bg-green-700';
            } else {
                 btn.className = 'p-4 rounded-lg text-left transition-colors duration-200 text-white bg-red-700';
            }
        });

        if (isCorrect) {
            score++;
            document.getElementById('real-quiz-score').innerText = `Punteggio: ${score}`;
        }
        nextQuizBtn.classList.remove('hidden');
    }

    function nextQuizQuestion() {
        currentRealQuizIndex++;
        displayQuizQuestion();
    }

    function showQuizResults() {
        realQuizScreen.classList.add('hidden');
        const realQuizResultsScreen = document.getElementById('real-quiz-results-screen');
        realQuizResultsScreen.classList.remove('hidden');
        const realQuizResultsMessage = document.getElementById('real-quiz-results-message');
        realQuizResultsMessage.innerHTML = `Quiz completato per ${currentSubjectInfo.subjectName}!<br>Punteggio finale: ${score} / ${currentRealQuizData.length}`;
    }

    function backToSubject() {
        document.getElementById('real-quiz-results-screen').classList.add('hidden');
        showHomeScreen();
    }

    document.addEventListener('keydown', (e) => {
      if (quizScreen.classList.contains('hidden')) return;
      if (e.key === 'ArrowRight' && !nextBtn.disabled) nextQuestion();
      else if (e.key === 'ArrowLeft' && !prevBtn.disabled) previousQuestion();
      else if (e.key === ' ' || e.key === 'ArrowUp' || e.key === 'ArrowDown') {
        e.preventDefault();
        flipCard();
      }
    });
    // --- Fine Funzioni di Navigazione e Quiz ---

    function buildSubjectDropdowns() {
        const container = document.getElementById('materie-list-container');
        if (!container) return;

        let allSubjectsHtml = '';

        for (const subjectId in subjectData) {
            const subject = subjectData[subjectId];
            const hasRealQuiz = questions[subjectId] && questions[subjectId].length >= 50;
            const hasFlashcard = questions[subjectId] && questions[subjectId].length > 0;

            allSubjectsHtml += `
              <div>
                <button id="subject-${subjectId}-toggle" class="sidebar-item w-full text-left flex justify-between items-center">
                    <h3 class="font-semibold text-sm">${subject.name}</h3>
                    <svg class="w-4 h-4 transition-transform transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                </button>
                <div id="subject-${subjectId}-dropdown" class="overflow-hidden transition-all duration-300 ease-in-out max-h-0">
                    <div class="pt-1 pb-1 pl-6 pr-2 space-y-2">
                        <a href="${subject.flipbook}" target="_blank" class="block w-full text-left p-2 rounded-md text-sm text-gray-400 hover:bg-gray-700 hover:text-white transition-colors">Flipbook</a>`;

            if (hasFlashcard) {
                allSubjectsHtml += `<button onclick="prepareAndStart('${subjectId}', 'flashcard')" class="block w-full text-left p-2 rounded-md text-sm text-gray-400 hover:bg-gray-700 hover:text-white transition-colors">Flashcard</button>`;
            }
            if (hasRealQuiz) {
                 allSubjectsHtml += `<button onclick="prepareAndStart('${subjectId}', 'realQuiz')" class="block w-full text-left p-2 rounded-md text-sm text-gray-400 hover:bg-gray-700 hover:text-white transition-colors">Quiz</button>`;
            }

            allSubjectsHtml += `</div></div></div>`;
        }
        container.innerHTML = allSubjectsHtml;
    }

    document.addEventListener('DOMContentLoaded', () => {
      buildSubjectDropdowns();

      document.getElementById('sidebar-list').addEventListener('click', e => {
        const toggleBtn = e.target.closest('[id$="-toggle"]');
        if (!toggleBtn) return;

        const dropdownId = toggleBtn.id.replace('-toggle', '-dropdown');
        const dropdown = document.getElementById(dropdownId);
        const arrow = toggleBtn.querySelector('svg');

        if (dropdown) {
            const isOpen = dropdown.classList.contains('max-h-[40rem]');
            if (isOpen) {
                dropdown.classList.remove('max-h-[40rem]');
                dropdown.classList.add('max-h-0');
                if (arrow) arrow.classList.remove('rotate-90');
            } else {
                dropdown.classList.remove('max-h-0');
                dropdown.classList.add('max-h-[40rem]');
                if (arrow) arrow.classList.add('rotate-90');
            }
        }
      });

      // 1. Inizializza il carosello
      initializeHomeCarousel();

      // 2. Mostra la Home e avvia il carosello
      showHomeScreen();

      // 3. Registra il Service Worker per la PWA
      if ('serviceWorker' in navigator) {
        const swContent = `
          self.addEventListener('install', event => {
            event.waitUntil(
              caches.open('studio-tai-cache-v1').then(cache => {
                return cache.addAll(['index.html']);
              })
            );
          });

          self.addEventListener('fetch', event => {
            event.respondWith(
              caches.match(event.request).then(response => {
                return response || fetch(event.request);
              })
            );
          });
        `;
        const swBlob = new Blob([swContent], { type: 'application/javascript' });
        const swUrl = URL.createObjectURL(swBlob);

        window.addEventListener('load', () => {
          navigator.serviceWorker.register(swUrl)
            .then(registration => {
              console.log('Service Worker registrato con successo:', registration);
            })
            .catch(error => {
              console.log('Registrazione del Service Worker fallita:', error);
            });
        });
      }

      // --- Sidebar Interaction Enhancements ---

      // 1. Hover to open/close on Desktop
      if (isDesktop()) {
        const sidebarHotzone = document.getElementById('sidebar-hotzone');
        let sidebarCloseTimeout;

        if (sidebarHotzone) {
            sidebarHotzone.addEventListener('mouseenter', () => {
              if (!isSidebarOpen()) {
                clearTimeout(sidebarCloseTimeout);
                toggleSidebar();
              }
            });
        }

        sidebar.addEventListener('mouseenter', () => {
          clearTimeout(sidebarCloseTimeout);
        });

        sidebar.addEventListener('mouseleave', () => {
          if (isSidebarOpen()) {
            sidebarCloseTimeout = setTimeout(() => {
              toggleSidebar();
            }, 300);
          }
        });
      }

      // 2. Swipe to open/close on Mobile
      if (!isDesktop()) {
        let touchstartX = 0;
        let touchstartY = 0;
        const swipeThreshold = 50; // Min distance in pixels for a swipe
        const swipeArea = 40; // Width of edge area to trigger open

        document.body.addEventListener('touchstart', e => {
            touchstartX = e.changedTouches[0].screenX;
            touchstartY = e.changedTouches[0].screenY;
        }, { passive: true });

        document.body.addEventListener('touchend', e => {
            const touchendX = e.changedTouches[0].screenX;
            const touchendY = e.changedTouches[0].screenY;

            const swipedX = touchendX - touchstartX;
            const swipedY = touchendY - touchstartY;

            // Ignore if it's more of a vertical swipe or not a clear swipe
            if (Math.abs(swipedX) < swipeThreshold || Math.abs(swipedX) < Math.abs(swipedY)) {
                return;
            }

            if (swipedX > 0 && touchstartX < swipeArea && !isSidebarOpen()) {
                // Swipe Right from left edge to Open
                toggleSidebar();
            } else if (swipedX < 0 && isSidebarOpen()) {
                // Swipe Left anywhere to Close
                toggleSidebar();
            }
        });
      }
    });
  </script>


  <!-- FIREBASE AUTH SCRIPT -->
  <script>
    (function() {
      const firebaseConfig = {
        apiKey: "AIzaSyDoDSzZurbHx0A9Ra-11U2VzrHJAJ00X8M",
        authDomain: "cnatai.firebaseapp.com",
        projectId: "cnatai",
        storageBucket: "cnatai.firebasestorage.app",
        messagingSenderId: "780153268227",
        appId: "1:780153268227:web:5c80b025581169efcb8636"
      };

      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();

      const overlay = document.getElementById('firebase-login-overlay');
      const form = document.getElementById('firebase-login-form');
      const emailInput = document.getElementById('firebase-email');
      const passwordInput = document.getElementById('firebase-password');
      const errorDiv = document.getElementById('firebase-error');
      const loginBtn = document.getElementById('firebase-login-btn');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = emailInput.value;
        const password = passwordInput.value;

        loginBtn.disabled = true;
        loginBtn.textContent = 'Accesso...';
        errorDiv.classList.add('hidden');

        try {
          await auth.signInWithEmailAndPassword(email, password);
        } catch (error) {
          let msg = 'Errore accesso';
          if (error.code === 'auth/user-not-found') msg = 'Utente non trovato';
          if (error.code === 'auth/wrong-password') msg = 'Password errata';
          if (error.code === 'auth/invalid-email') msg = 'Email non valida';

          errorDiv.textContent = msg;
          errorDiv.classList.remove('hidden');
          loginBtn.disabled = false;
          loginBtn.textContent = 'Accedi';
        }
      });

      auth.onAuthStateChanged((user) => {
        if (user) {
          overlay.style.display = 'none';
          const sidebar = document.getElementById('sidebar');
          let logoutDiv = document.getElementById('firebase-logout-section');
          if (!logoutDiv) {
            logoutDiv = document.createElement('div');
            logoutDiv.id = 'firebase-logout-section';
            logoutDiv.className = 'mt-auto pt-4 border-t border-gray-700';
            sidebar.appendChild(logoutDiv);
          }
          logoutDiv.innerHTML = '<div class="text-gray-400 text-xs mb-2 px-2 truncate">' + user.email + '</div><button onclick="firebase.auth().signOut()" class="w-full px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm">Logout</button>';
        } else {
          overlay.style.display = 'flex';
          const logoutDiv = document.getElementById('firebase-logout-section');
          if (logoutDiv) logoutDiv.remove();
        }
      });
    })();


    // ====== PRESENZE - GRAFICO CON NOMI + FIX VISIBILITA ======

    function initializePresenzeHandlers() {
      const strumentiToggle = document.getElementById('strumenti-toggle');
      const strumentiDropdown = document.getElementById('strumenti-dropdown');
      const prezenzeBtn = document.getElementById('presenze-btn');

      if (strumentiToggle && strumentiDropdown) {
        strumentiToggle.addEventListener('click', function() {
          const isOpen = strumentiDropdown.style.maxHeight && strumentiDropdown.style.maxHeight !== '0px';
          if (isOpen) {
            strumentiDropdown.style.maxHeight = '0px';
          } else {
            strumentiDropdown.style.maxHeight = strumentiDropdown.scrollHeight + 'px';
          }
        });
      }

      if (prezenzeBtn) {
        prezenzeBtn.addEventListener('click', function(e) {
          e.preventDefault();
          showPresenzeScreen();
        });
      }
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initializePresenzeHandlers);
    } else {
      initializePresenzeHandlers();
    }

    let presenzeData = [];
    let prezenzeChart = null;

    function showPresenzeScreen() {
      document.getElementById('home-screen').classList.add('hidden');
      document.getElementById('subject-screen').classList.add('hidden');
      document.getElementById('quiz-screen').classList.add('hidden');
      document.getElementById('real-quiz-screen').classList.add('hidden');
      document.getElementById('real-quiz-results-screen').classList.add('hidden');
      document.getElementById('presenze-screen').classList.remove('hidden');
      loadPresenzeData();
    }

    function loadPresenzeData() {
      const spreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1ytDd1n5vqhGooCpZ-25Vt93x8jUJGRkp/export?format=csv&gid=222758920';

      fetch(spreadsheetUrl)
        .then(response => response.text())
        .then(csv => {
          presenzeData = parsePresenzeCSV(csv);
          renderChart();
        })
        .catch(error => {
          console.error('Errore:', error);
        });
    }

    function parsePresenzeCSV(csv) {
      const data = [];
      const lines = csv.trim().split('\n');
      for (let i = 1; i < lines.length; i++) {
        if (!lines[i].trim()) continue;
        const values = parseCSVLine(lines[i]);

        if (values.length < 6) continue;
        if (values[0].includes('COGNOME') || values[1].includes('COGNOME')) continue;

        const cognome = (values[1] || '').trim();
        const nome = (values[2] || '').trim();
        const oreCorse = parseInt(values[4]) || 111;
        const oreSvolte = parseFloat(values[5].replace(',', '.')) || 0;

        if (!cognome) continue;

        data.push({
          cognome: cognome,
          nome: nome,
          ore_corso: oreCorse,
          ore_svolte: oreSvolte
        });
      }
      return data;
    }

    function parseCSVLine(line) {
      const result = [];
      let current = '';
      let inQuotes = false;
      for (let i = 0; i < line.length; i++) {
        const char = line[i];
        if (char === '"') {
          if (inQuotes && line[i + 1] === '"') {
            current += '"';
            i++;
          } else {
            inQuotes = !inQuotes;
          }
        } else if (char === ',' && !inQuotes) {
          result.push(current.trim());
          current = '';
        } else {
          current += char;
        }
      }
      result.push(current.trim());
      return result;
    }

    function renderChart() {
      if (presenzeData.length === 0) return;

      // --- START: Calcoli per il dashboard di riepilogo ---
      const totalStudents = presenzeData.length;
      const totalPercentageSum = presenzeData.reduce((sum, student) => {
          const percentage = (student.ore_svolte / student.ore_corso) * 100;
          return sum + (isNaN(percentage) ? 0 : percentage);
      }, 0);
      const averageAttendance = totalStudents > 0 ? totalPercentageSum / totalStudents : 0;

      const studentsAbove90 = presenzeData.filter(s => (s.ore_svolte / s.ore_corso) * 100 >= 90).length;
      const studentsBelow70 = presenzeData.filter(s => (s.ore_svolte / s.ore_corso) * 100 <= 70).length;

      // Popola le card del dashboard
      const avgEl = document.getElementById('avg-attendance-value');
      const totalEl = document.getElementById('students-total');
      const safeEl = document.getElementById('students-safe');
      const dangerEl = document.getElementById('students-danger');

      if(avgEl) avgEl.innerText = `${averageAttendance.toFixed(1)}%`;
      if(totalEl) totalEl.innerText = totalStudents;
      if(safeEl) safeEl.innerText = studentsAbove90;
      if(dangerEl) dangerEl.innerText = studentsBelow70;
      // --- END: Calcoli per il dashboard di riepilogo ---


      const ctx = document.getElementById('presenze-chart');
      if (!ctx) return;

      // Sort data in descending order by percentage
      presenzeData.sort((a, b) => {
        const percentageA = (a.ore_svolte / a.ore_corso) * 100;
        const percentageB = (b.ore_svolte / b.ore_corso) * 100;
        return percentageB - percentageA;
      });

      // LABELS CON COGNOME E NOME
      const labels = presenzeData.map(d => {
        if (d.cognome.toUpperCase().includes('DE LA ROSA')) {
          return 'DE LA ROSA WILLIAM';
        }
        return d.cognome + ' ' + d.nome;
      });
      const dataValues = presenzeData.map(d => Math.round((d.ore_svolte / d.ore_corso) * 100));

      const colors = dataValues.map(val => {
        if (val >= 90) return 'rgba(34, 197, 94, 0.8)';
        if (val >= 80) return 'rgba(234, 179, 8, 0.8)';
        if (val > 70) return 'rgba(249, 115, 22, 0.8)';
        return 'rgba(239, 68, 68, 0.8)';
      });

      const borderColors = dataValues.map(val => {
        if (val >= 90) return 'rgba(34, 197, 94, 1)';
        if (val >= 80) return 'rgba(234, 179, 8, 1)';
        if (val > 70) return 'rgba(249, 115, 22, 1)';
        return 'rgba(239, 68, 68, 1)';
      });

      if (prezenzeChart) {
        prezenzeChart.destroy();
      }

      prezenzeChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Percentuale Ore Svolte (%)',
            data: dataValues,
            backgroundColor: colors,
            borderColor: borderColors,
            borderWidth: 2,
            borderRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: 'y',
          scales: {
            x: {
              max: 100,
              ticks: {
                callback: function(value) {
                  return value + '%';
                },
                color: 'rgba(156, 163, 175, 0.8)'
              },
              grid: {
                color: 'rgba(107, 114, 128, 0.2)'
              }
            },
            y: {
              ticks: {
                color: 'rgba(156, 163, 175, 0.8)',
                font: { size: 11 }
              },
              grid: { display: false }
            }
          },
          plugins: {
            legend: {
              display: false,
              labels: {
                color: 'rgba(156, 163, 175, 0.8)',
                font: { size: 12 }
              }
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return context.parsed.x + '%';
                }
              }
            }
          }
        }
      });
    }
  </script></script>
</body>
</html>
